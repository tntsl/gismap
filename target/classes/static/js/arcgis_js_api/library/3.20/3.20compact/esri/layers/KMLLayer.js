// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.20/esri/copyright.txt for details.
//>>built
require({cache:{"esri/dijit/PopupTemplate":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/dom-construct ../kernel ../InfoTemplate ../PopupInfo ./PopupRenderer".split(" "),function(m,n,g,l,e,a,r,b){m=m([a,r],{declaredClass:"esri.dijit.PopupTemplate","-chains-":{constructor:"manual"},chartTheme:null,constructor:function(a,f){n.mixin(this,f);this.initialize(a,f)},getTitle:function(a){var f;this.info&&(f=this.titleHasRelatedFields?"":this._getPopupValues(a,!0).title);return f||""},
getContent:function(a){return this.info?(new b({template:this,graphic:a,chartTheme:this.chartTheme},l.create("div"))).domNode:""}});g("extend-esri")&&n.setObject("dijit.PopupTemplate",m,e);return m})},"esri/PopupInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/i18n dojo/has dojo/Deferred dojo/sniff dojo/promise/all ./lang ./kernel ./request ./tasks/query ./tasks/QueryTask ./tasks/RelationshipQuery ./tasks/StatisticDefinition dojo/i18n!dojo/cldr/nls/number".split(" "),
function(m,n,g,l,e,a,r,b,k,f,v,A,E,x,z,D,F){m=m(null,{declaredClass:"esri.PopupInfo",initialize:function(a,f){if(a){n.mixin(this,f);this.info=a;this.title=this.getTitle;this.content=this.getContent;var y=this._fieldLabels={},B=this._fieldsMap={};a.fieldInfos&&g.forEach(a.fieldInfos,function(q){var p=q.fieldName.toLowerCase();y[p]=q.label;B[p]=q});this._relatedFieldPrefix="relationships/";this.titleHasRelatedFields=!(!a.title||-1===a.title.indexOf("{"+this._relatedFieldPrefix))}},toJson:function(){return l.fromJson(l.toJson(this.info))},
getTitle:function(){},getContent:function(){},getFieldInfo:function(a){var y;g.some(this.info&&this.info.fieldInfos,function(f){f.fieldName===a&&(y=f);return!!y});return y},getComponents:function(a){var y=this.info,f=new r,e,q;y.fieldInfos&&(q=g.filter(y.fieldInfos,function(q){return-1!==q.fieldName.indexOf(this._relatedFieldPrefix)},this));q&&0<q.length&&(e=this._getRelatedRecords({graphic:a,fieldsInfo:q}));e?e.always(n.hitch(this,function(){f.resolve(this._getPopupValues(a))})):f.resolve(this._getPopupValues(a));
return f.promise},getAttachments:function(a){var f=a.getLayer();a=a.attributes;if(this.info.showAttachments&&f&&f.hasAttachments&&f.objectIdField&&(a=a&&a[f.objectIdField]))return f.queryAttachmentInfos(a)},_getPopupValues:function(a,e){var y=this.info,b=a.getLayer(),q=n.clone(a.attributes)||{},p=n.clone(q),t=y.fieldInfos,h="",d="",c,u,w,B,k,G=b&&b._getDateOpts&&b._getDateOpts().properties,G=G&&G.slice(0),l={dateFormat:{properties:G,formatter:"DateFormat"+this._insertOffset(this._dateFormats.shortDateShortTime)}};
if(this._relatedInfo)for(B in this._relatedInfo)if(this._relatedInfo.hasOwnProperty(B)){var r=this._relatedInfo[B],v=this._relatedLayersInfo[B];r&&(g.forEach(r.relatedFeatures,function(c){for(k in c.attributes)if(c.attributes.hasOwnProperty(k)&&"esriRelCardinalityOneToOne"===v.relation.cardinality){var d=this._toRelatedFieldName([v.relation.id,k]);q[d]=p[d]=c.attributes[k]}},this),g.forEach(r.relatedStatsFeatures,function(c){for(k in c.attributes)if(c.attributes.hasOwnProperty(k)){var d=this._toRelatedFieldName([v.relation.id,
k]);q[d]=p[d]=c.attributes[k]}},this))}t&&g.forEach(t,function(c){u=c.fieldName;var d=this._getLayerFieldInfo(b,u);d&&(u=c.fieldName=d.name);p[u]=this._formatValue(p[u],u,l);G&&c.format&&c.format.dateFormat&&(c=g.indexOf(G,u),-1<c&&G.splice(c,1))},this);if(b){B=b.types;var E=(r=b.typeIdField)&&q[r];for(u in q)if(q.hasOwnProperty(u)&&-1===u.indexOf(this._relatedFieldPrefix)&&(w=q[u],f.isDefined(w))){var m=this._getDomainName(b,a,B,E,u,w);f.isDefined(m)?p[u]=m:u===r&&(m=this._getTypeName(b,a,w),f.isDefined(m)&&
(p[u]=m))}}y.title&&(h=this._processFieldsInLinks(this._fixTokens(y.title,b),q),h=n.trim(f.substitute(p,h,l)||""));if(e)return{title:h};y.description&&(d=this._processFieldsInLinks(this._fixTokens(y.description,b),q),d=n.trim(f.substitute(p,d,l)||""));t&&(c=[],g.forEach(t,function(d){(u=d.fieldName)&&d.visible&&c.push([d.label||u,f.substitute(p,"${"+u+"}",l)||""])}));var A,x;y.mediaInfos&&(A=[],g.forEach(y.mediaInfos,function(c){x=0;w=c.value;switch(c.type){case "image":var d=w.sourceURL,d=d&&n.trim(f.substitute(q,
this._fixTokens(d,b)));x=!!d;break;case "piechart":case "linechart":case "columnchart":case "barchart":var h,d=w.normalizeField;w.fields=g.map(w.fields,function(c){return(h=this._getLayerFieldInfo(b,c))?h.name:c},this);d&&(h=this._getLayerFieldInfo(b,d),w.normalizeField=h?h.name:d);x=g.some(w.fields,function(c){return f.isDefined(q[c])||-1!==c.indexOf(this._relatedFieldPrefix)&&this._relatedInfo},this);break;default:return}if(x){c=n.clone(c);w=c.value;var d=c.title?this._processFieldsInLinks(this._fixTokens(c.title,
b),q):"",u=c.caption?this._processFieldsInLinks(this._fixTokens(c.caption,b),q):"";c.title=d?n.trim(f.substitute(p,d,l)||""):"";c.caption=u?n.trim(f.substitute(p,u,l)||""):"";if("image"===c.type)w.sourceURL=f.substitute(q,this._fixTokens(w.sourceURL,b)),w.linkURL&&(w.linkURL=n.trim(f.substitute(q,this._fixTokens(w.linkURL,b))||""));else{var a,t;g.forEach(w.fields,function(c,d){if(-1!==c.indexOf(this._relatedFieldPrefix))t=this._getRelatedChartInfos(c,w,q,l),t instanceof Array?w.fields=t:w.fields[d]=
t;else{var h=q[c],h=void 0===h?null:h;a=q[w.normalizeField]||0;h&&a&&(h/=a);w.fields[d]={y:h,tooltip:(this._fieldLabels[c.toLowerCase()]||c)+":\x3cbr/\x3e"+this._formatValue(h,c,l,!!a)}}},this)}A.push(c)}},this));return{title:h,description:d,hasDescription:!!y.description,fields:c&&c.length?c:null,mediaInfos:A&&A.length?A:null,formatted:p,editSummary:b&&b.getEditSummary?b.getEditSummary(a):""}},_getRelatedChartInfos:function(a,b,e,k){var q,p,t,h,d,c;q=[];c=this._fromRelatedFieldName(a);d=c[0];p=this._relatedInfo[d];
d=this._relatedLayersInfo[d];p&&g.forEach(p.relatedFeatures,function(d){d=d.attributes;var u,p;for(p in d)if(d.hasOwnProperty(p)&&p===c[1]){u={};h=d[p];b.normalizeField&&(t=-1!==b.normalizeField.indexOf(this._relatedFieldPrefix)?d[this._fromRelatedFieldName(b.normalizeField)[1]]:e[b.normalizeField]);h&&t&&(h/=t);if(b.tooltipField)if(-1!==b.tooltipField.indexOf(this._relatedFieldPrefix)){var y=this._fromRelatedFieldName(b.tooltipField)[1],G=f.isDefined(d[y])?d[y]:y;u.tooltip=G+":\x3cbr/\x3e"+this._formatValue(h,
y,k,!!t)}else u.tooltip=(this._fieldLabels[a.toLowerCase()]||a)+":\x3cbr/\x3e"+this._formatValue(h,b.tooltipField,k,!!t);else u.tooltip=h;u.y=h;q.push(u)}},this);return"esriRelCardinalityOneToMany"===d.relation.cardinality||"esriRelCardinalityManyToMany"===d.relation.cardinality?q:q[0]},_dateFormats:{shortDate:"(datePattern: 'M/d/y', selector: 'date')",shortDateLE:"(datePattern: 'd/M/y', selector: 'date')",longMonthDayYear:"(datePattern: 'MMMM d, y', selector: 'date')",dayShortMonthYear:"(datePattern: 'd MMM y', selector: 'date')",
longDate:"(datePattern: 'EEEE, MMMM d, y', selector: 'date')",shortDateShortTime:"(datePattern: 'M/d/y', timePattern: 'h:mm a', selector: 'date and time')",shortDateLEShortTime:"(datePattern: 'd/M/y', timePattern: 'h:mm a', selector: 'date and time')",shortDateShortTime24:"(datePattern: 'M/d/y', timePattern: 'H:mm', selector: 'date and time')",shortDateLEShortTime24:"(datePattern: 'd/M/y', timePattern: 'H:mm', selector: 'date and time')",shortDateLongTime:"(datePattern: 'M/d/y', timePattern: 'h:mm:ss a', selector: 'date and time')",
shortDateLELongTime:"(datePattern: 'd/M/y', timePattern: 'h:mm:ss a', selector: 'date and time')",shortDateLongTime24:"(datePattern: 'M/d/y', timePattern: 'H:mm:ss', selector: 'date and time')",shortDateLELongTime24:"(datePattern: 'd/M/y', timePattern: 'H:mm:ss', selector: 'date and time')",longMonthYear:"(datePattern: 'MMMM y', selector: 'date')",shortMonthYear:"(datePattern: 'MMM y', selector: 'date')",year:"(datePattern: 'y', selector: 'date')"},_reHref:/href\s*=\s*\"([^\"]+)\"/ig,_reHrefApos:/href\s*=\s*\'([^\']+)\'/ig,
_fixTokens:function(a,f){var b=this;return a.replace(/(\{([^\{\r\n]+)\})/g,function(a,q,p){a=b._getLayerFieldInfo(f,p);return"$"+(a?"{"+a.name+"}":q)})},_encodeAttributes:function(a){a=n.clone(a)||{};var f,b;for(f in a)(b=a[f])&&"string"===typeof b&&(b=encodeURIComponent(b).replace(/\'/g,"\x26apos;"),a[f]=b);return a},_processFieldsInLinks:function(a,b){var f=this._encodeAttributes(b),e=this;a&&(a=a.replace(this._reHref,function(a,p){return e._addValuesToHref(a,p,b,f)}).replace(this._reHrefApos,function(a,
p){return e._addValuesToHref(a,p,b,f)}));return a},_addValuesToHref:function(a,b,e,k){b=b&&n.trim(b);return f.substitute(b&&0===b.indexOf("${")?e:k,a)},_getLayerFieldInfo:function(a,b){return a&&a.getField?a.getField(b):null},_formatValue:function(a,b,e,k){var q=this._fieldsMap[b.toLowerCase()],p=q&&q.format;b=-1!==g.indexOf(e.dateFormat.properties,b);var t="number"===typeof a&&!b&&(!p||!p.dateFormat);if(!f.isDefined(a)||!q||!f.isDefined(p))return t?this._forceLTR(a):a;var h="",q=[],d=p.hasOwnProperty("places")||
p.hasOwnProperty("digitSeparator"),c=p.hasOwnProperty("digitSeparator")?p.digitSeparator:!0;if(d&&!b)h="NumberFormat",q.push("places: "+(f.isDefined(p.places)&&(!k||0<p.places)?Number(p.places):"Infinity")),q.length&&(h+="("+q.join(",")+")");else if(p.dateFormat)h="DateFormat"+this._insertOffset(this._dateFormats[p.dateFormat]||this._dateFormats.shortDateShortTime);else return t?this._forceLTR(a):a;var u=this._applyFormatting(a,h,e);d&&-1<a.constructor.toString().indexOf("Array")&&(u="",g.forEach(a,
n.hitch(this,function(c,d){d&&(u+=" ");u+=this._applyFormatting(c,h,e)})));d&&!c&&F.group&&(u=u.replace(new RegExp("\\"+F.group,"g"),""));b&&(u='\x3cspan class\x3d"esriDateValue"\x3e'+u+"\x3c/span\x3e");return t?this._forceLTR(u):u},_applyFormatting:function(a,b,e){return f.substitute({myKey:a},"${myKey:"+b+"}",e)||""},_forceLTR:function(a){var f=b("ie");return f&&10>=f?a:"\x3cspan class\x3d'esriNumericValue'\x3e"+a+"\x3c/span\x3e"},_insertOffset:function(a){a&&(a=f.isDefined(this.utcOffset)?a.replace(/\)\s*$/,
", utcOffset:"+this.utcOffset+")"):a);return a},_getDomainName:function(a,b,f,e,q,p){return(a=a.getDomain&&a.getDomain(q,{feature:b}))&&a.codedValues?a.getName(p):null},_getTypeName:function(a,b,f){return(a=a.getType&&a.getType(b))&&a.name},_getRelatedRecords:function(a){var b=a.graphic,f=new r,e;this._relatedLayersInfo?this._queryRelatedLayers(b).then(n.hitch(this,function(a){this._setRelatedRecords(b,a);f.resolve(a)}),n.hitch(this,this._handlerErrorResponse,f)):this._getRelatedLayersInfo(a).then(n.hitch(this,
function(a){for(e in a)a.hasOwnProperty(e)&&a[e]&&(this._relatedLayersInfo[e].relatedLayerInfo=a[e]);this._queryRelatedLayers(b).then(n.hitch(this,function(a){this._setRelatedRecords(b,a);f.resolve(a)}),n.hitch(this,this._handlerErrorResponse,f))}),n.hitch(this,this._handlerErrorResponse,f));return f.promise},_getRelatedLayersInfo:function(a){var b=a.fieldsInfo,f,e,q={};f=a.graphic.getLayer();this._relatedLayersInfo||(this._relatedLayersInfo={});g.forEach(b,function(a){var b,h,d,c;b=this._fromRelatedFieldName(a.fieldName);
h=b[0];b=b[1];h&&(this._relatedLayersInfo[h]||(g.some(f.relationships,function(d){if(d.id==h)return c=d,!0}),c&&(this._relatedLayersInfo[h]={relation:c,relatedFields:[],outStatistics:[]})),this._relatedLayersInfo[h]&&(this._relatedLayersInfo[h].relatedFields.push(b),a.statisticType&&(d=new D,d.statisticType=a.statisticType,d.onStatisticField=b,d.outStatisticFieldName=b,this._relatedLayersInfo[h].outStatistics.push(d))))},this);for(e in this._relatedLayersInfo)this._relatedLayersInfo.hasOwnProperty(e)&&
this._relatedLayersInfo[e]&&(a=this._relatedLayersInfo[e].relation,a=f.url.replace(/[0-9]+$/,a.relatedTableId),this._relatedLayersInfo[e].relatedLayerUrl=a,q[e]=A({url:a,content:{f:"json"},callbackParamName:"callback"}));return k(q)},_queryRelatedLayers:function(a){var b={},f;for(f in this._relatedLayersInfo)this._relatedLayersInfo.hasOwnProperty(f)&&(b[f]=this._queryRelatedLayer({graphic:a,relatedInfo:this._relatedLayersInfo[f]}));return k(b)},_queryRelatedLayer:function(a){var b,f,e,q,p,t,h,d,c,
u,w,l,v;b=a.graphic;f=b.getLayer();e=f.url.match(/[0-9]+$/g)[0];w=a.relatedInfo;u=w.relatedLayerInfo;l=w.relatedLayerUrl;a=w.relation;g.some(u.relationships,function(c){if(c.relatedTableId===parseInt(e,10))return q=c,!0},this);q&&(p=new E,g.some(u.fields,function(c){if(c.name===q.keyField)return d=-1!==g.indexOf(["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],c.type)?"number":"string",!0}),q.relationshipTableId&&q.keyFieldInRelationshipTable?(v=new r,
this._queryRelatedRecords(b,q).then(n.hitch(this,function(d){var a;a=d[b.attributes[f.objectIdField]];d=g.map(a.features,function(c){return c.attributes[u.objectIdField]},this);w.outStatistics&&0<w.outStatistics.length&&u.supportsStatistics&&(c=new E,c.objectIds=d,c.outFields=p.outFields,c.outStatistics=w.outStatistics);c&&(t=new x(l),t.execute(c).then(n.hitch(this,function(c){var d=[];d.push(a);d.push(c);v.resolve(d)})))}))):(h="string"===d?q.keyField+"\x3d'"+b.attributes[a.keyField]+"'":q.keyField+
"\x3d"+b.attributes[a.keyField],p.where=h,p.outFields=w.relatedFields,w.outStatistics&&0<w.outStatistics.length&&u.supportsStatistics&&(c=new E,c.where=p.where,c.outFields=p.outFields,c.outStatistics=w.outStatistics),t=new x(l),h=[],h.push(t.execute(p)),c&&h.push(t.execute(c))));return h?k(h):v?v.promise:void 0},_setRelatedRecords:function(a,b){this._relatedInfo=[];for(var e in b)if(b.hasOwnProperty(e)&&b[e]){var k=b[e];this._relatedInfo[e]={};this._relatedInfo[e].relatedFeatures=k[0].features;f.isDefined(k[1])&&
(this._relatedInfo[e].relatedStatsFeatures=k[1].features)}},_handlerErrorResponse:function(a,b){a.reject(b)},_fromRelatedFieldName:function(a){var b=[];-1!==a.indexOf(this._relatedFieldPrefix)&&(a=a.split("/"),b=a.slice(1));return b},_toRelatedFieldName:function(a){var b="";a&&0<a.length&&(b=this._relatedFieldPrefix+a[0]+"/"+a[1]);return b},_queryRelatedRecords:function(a,b){var f=a.getLayer(),e=new z;e.outFields=["*"];e.relationshipId=b.id;e.objectIds=[a.attributes[f.objectIdField]];return f.queryRelatedFeatures(e)}});
a("extend-esri")&&(v.PopupInfo=v.PopupInfoTemplate=m);return m})},"esri/tasks/RelationshipQuery":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/json","dojo/has","../kernel"],function(m,n,g,l,e){m=m(null,{declaredClass:"esri.tasks.RelationshipQuery",definitionExpression:"",relationshipId:null,returnGeometry:!1,objectIds:null,outSpatialReference:null,outFields:null,toJson:function(){var a={definitionExpression:this.definitionExpression,relationshipId:this.relationshipId,returnGeometry:this.returnGeometry,
maxAllowableOffset:this.maxAllowableOffset,geometryPrecision:this.geometryPrecision},e=this.objectIds,b=this.outFields,k=this.outSpatialReference;e&&(a.objectIds=e.join(","));b&&(a.outFields=b.join(","));k&&(a.outSR=k.wkid||g.toJson(k.toJson()));a._ts=this._ts;return a}});l("extend-esri")&&n.setObject("tasks.RelationshipQuery",m,e);return m})},"esri/dijit/PopupRenderer":function(){define("require dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/kernel dojo/sniff dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-style dojox/html/entities dijit/_Widget dijit/_Templated ../kernel ../urlUtils ./_EventedWidget dojo/i18n!../nls/jsapi dojo/NodeList-dom".split(" "),
function(m,n,g,l,e,a,r,b,k,f,v,A,E,x,z,D,F,y,B,I){var J=0;n=n([B,z,D],{declaredClass:"esri.dijit._PopupRenderer",constructor:function(){this._nls=l.mixin({},I.widgets.popup)},templateString:"\x3cdiv class\x3d'esriViewPopup'\x3e\x3cdiv class\x3d'mainSection'\x3e\x3cdiv class\x3d'header' dojoAttachPoint\x3d'_title'\x3e\x3c/div\x3e\x3cdiv class\x3d'hzLine'\x3e\x3c/div\x3e\x3cdiv dojoAttachPoint\x3d'_description'\x3e\x3c/div\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'attachmentsSection hidden'\x3e\x3cdiv\x3e${_nls.NLS_attach}:\x3c/div\x3e\x3cul dojoAttachPoint\x3d'_attachmentsList'\x3e\x3c/ul\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'mediaSection hidden'\x3e\x3cdiv class\x3d'header' dojoAttachPoint\x3d'_mediaTitle'\x3e\x3c/div\x3e\x3cdiv class\x3d'hzLine'\x3e\x3c/div\x3e\x3cdiv class\x3d'caption' dojoAttachPoint\x3d'_mediaCaption'\x3e\x3c/div\x3e\x3cdiv class\x3d'gallery' dojoAttachPoint\x3d'_gallery'\x3e\x3cdiv class\x3d'mediaHandle prev' dojoAttachPoint\x3d'_prevMedia' dojoAttachEvent\x3d'onclick: _goToPrevMedia'\x3e\x3c/div\x3e\x3cdiv class\x3d'mediaHandle next' dojoAttachPoint\x3d'_nextMedia' dojoAttachEvent\x3d'onclick: _goToNextMedia'\x3e\x3c/div\x3e\x3cul class\x3d'summary'\x3e\x3cli class\x3d'image mediaCount hidden' dojoAttachPoint\x3d'_imageCount'\x3e0\x3c/li\x3e\x3cli class\x3d'image mediaIcon hidden'\x3e\x3c/li\x3e\x3cli class\x3d'chart mediaCount hidden' dojoAttachPoint\x3d'_chartCount'\x3e0\x3c/li\x3e\x3cli class\x3d'chart mediaIcon hidden'\x3e\x3c/li\x3e\x3c/ul\x3e\x3cdiv class\x3d'frame' dojoAttachPoint\x3d'_mediaFrame'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'editSummarySection hidden' dojoAttachPoint\x3d'_editSummarySection'\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3cdiv class\x3d'break hidden' dojoAttachPoint\x3d'_mediaBreak'\x3e\x3c/div\x3e\x3cdiv class\x3d'editSummary' dojoAttachPoint\x3d'_editSummary'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e",
showTitle:!0,startup:function(){this.inherited(arguments);this.template.getComponents(this.graphic).then(l.hitch(this,this._handleComponentsSuccess),l.hitch(this,this._handleComponentsError))},destroy:function(){this._dfd&&this._dfd.cancel();this._destroyFrame();this.template=this.graphic=this._nls=this._mediaInfos=this._mediaPtr=this._dfd=null;this.inherited(arguments)},_goToPrevMedia:function(){0>this._mediaPtr-1||(this._mediaPtr--,this._updateUI(),this._displayMedia())},_goToNextMedia:function(){this._mediaPtr+
1!==this._mediaInfos.length&&(this._mediaPtr++,this._updateUI(),this._displayMedia())},_updateUI:function(){var b=this._mediaInfos,p=b.length,t=this.domNode,h=this._prevMedia,d=this._nextMedia;if(1<p){var c=0,u=0;e.forEach(b,function(d){"image"===d.type?c++:-1!==d.type.indexOf("chart")&&u++});c&&(f.set(this._imageCount,"innerHTML",c),a.query(".summary .image",t).removeClass("hidden"));u&&(f.set(this._chartCount,"innerHTML",u),a.query(".summary .chart",t).removeClass("hidden"))}else a.query(".summary",
t).addClass("hidden"),v.add(h,"hidden"),v.add(d,"hidden");b=this._mediaPtr;0===b?v.add(h,"hidden"):v.remove(h,"hidden");b===p-1?v.add(d,"hidden"):v.remove(d,"hidden");this._destroyFrame()},_displayMedia:function(){var b=this._mediaInfos[this._mediaPtr],p=b.title,e=b.caption,h=a.query(".mediaSection .hzLine",this.domNode)[0];f.set(this._mediaTitle,"innerHTML",p);v[p?"remove":"add"](this._mediaTitle,"hidden");f.set(this._mediaCaption,"innerHTML",e);v[e?"remove":"add"](this._mediaCaption,"hidden");v[p&&
e?"remove":"add"](h,"hidden");this._rid=null;if("image"===b.type)this._showImage(b.value);else{var d=this,p=["dojox/charting/Chart2D","dojox/charting/action2d/Tooltip"],e=b.value.theme||this.chartTheme;l.isString(e)&&(e=e.replace(/\./gi,"/"),-1===e.indexOf("/")&&(e="dojox/charting/themes/"+e));e||(e="./Rainbow");p.push(e);try{var c=this._rid=J++;m(p,function(a,h,e){c===d._rid&&(d._rid=null,d._showChart(b.type,b.value,a,h,e))})}catch(u){console.log("PopupRenderer: error loading modules")}}},_preventNewTab:function(a){return(a=
a&&l.trim(a).toLowerCase())&&(0===a.indexOf("mailto:")||0===a.indexOf("tel:"))},_showImage:function(b){v.add(this._mediaFrame,"image");var e=E.get(this._gallery,"height"),f;b.linkURL&&(f=A.create("a",{href:b.linkURL,target:this._preventNewTab(b.linkURL)?"":"_blank"},this._mediaFrame));A.create("img",{className:"esriPopupMediaImage",src:b.sourceURL},f||this._mediaFrame);var h=a.query(".esriPopupMediaImage",this._mediaFrame)[0],d=this,c;c=g.connect(h,"onload",function(){g.disconnect(c);c=null;d._imageLoaded(h,
e)})},_showChart:function(a,b,f,h,d){v.remove(this._mediaFrame,"image");f=this._chart=new f(A.create("div",{"class":"chart"},this._mediaFrame),{margins:{l:4,t:4,r:4,b:4}});d&&f.setTheme(d);switch(a){case "piechart":f.addPlot("default",{type:"Pie",labels:!1});f.addSeries("Series A",b.fields);break;case "linechart":f.addPlot("default",{type:"Markers"});f.addAxis("x",{min:0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1});f.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});e.forEach(b.fields,
function(c,d){c.x=d+1});f.addSeries("Series A",b.fields);break;case "columnchart":f.addPlot("default",{type:"Columns",gap:3});f.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});f.addSeries("Series A",b.fields);break;case "barchart":f.addPlot("default",{type:"Bars",gap:3}),f.addAxis("x",{includeZero:!0,fixUpper:"minor",minorLabels:!1}),f.addAxis("y",{vertical:!0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1}),f.addSeries("Series A",b.fields)}this._action=new h(f);f.render()},
_destroyFrame:function(){this._rid=null;this._chart&&(this._chart.destroy(),this._chart=null);this._action&&(this._action.destroy(),this._action=null);f.set(this._mediaFrame,"innerHTML","")},_imageLoaded:function(a,b){var f=a.height;f<b&&E.set(a,"marginTop",Math.round((b-f)/2)+"px")},_attListHandler:function(a,b){if(a===this._dfd){this._dfd=null;var p="";b instanceof Error||!b||!b.length||e.forEach(b,function(a){p+="\x3cli\x3e";p+="\x3ca href\x3d'"+y.addProxy(a.url)+"' target\x3d'_blank'\x3e"+(a.name||
"[No name]")+"\x3c/a\x3e";p+="\x3c/li\x3e"});f.set(this._attachmentsList,"innerHTML",p||"\x3cli\x3e"+this._nls.NLS_noAttach+"\x3c/li\x3e")}},_handleComponentsSuccess:function(b){if(b){var p=this.showTitle?b.title:"",q=b.description,h=b.fields,d=b.mediaInfos,c=this.domNode,u=this._nls,w=this,n=this.template,g=this.graphic;this._prevMedia.title=u.NLS_prevMedia;this._nextMedia.title=u.NLS_nextMedia;f.set(this._title,"innerHTML",p);p||v.add(this._title,"hidden");!b.hasDescription&&h&&(q="",e.forEach(h,
function(c){q+="\x3ctr valign\x3d'top'\x3e";q+="\x3ctd class\x3d'attrName'\x3e"+x.encode(c[0])+"\x3c/td\x3e";q+="\x3ctd class\x3d'attrValue'\x3e"+c[1].replace(/^\s*(https?:\/\/[^\s]+)\s*$/i,"\x3ca target\x3d'_blank' href\x3d'$1' title\x3d'$1'\x3e"+u.NLS_moreInfo+"\x3c/a\x3e")+"\x3c/td\x3e";q+="\x3c/tr\x3e"}),q&&(q="\x3ctable class\x3d'attrTable' cellpadding\x3d'0px' cellspacing\x3d'0px'\x3e"+q+"\x3c/table\x3e"));f.set(this._description,"innerHTML",q);q||v.add(this._description,"hidden");a.query("a",
this._description).forEach(function(c){w._preventNewTab(c.href)?"_blank"===c.target&&f.remove(c,"target"):f.set(c,"target","_blank")});p&&q?a.query(".mainSection .hzLine",c).removeClass("hidden"):p||q?a.query(".mainSection .hzLine",c).addClass("hidden"):a.query(".mainSection",c).addClass("hidden");if(p=this._dfd=n.getAttachments(g))p.addBoth(l.hitch(this,this._attListHandler,p)),f.set(this._attachmentsList,"innerHTML","\x3cli\x3e"+u.NLS_searching+"...\x3c/li\x3e"),a.query(".attachmentsSection",c).removeClass("hidden");
d&&d.length&&(a.query(".mediaSection",c).removeClass("hidden"),k.setSelectable(this._mediaFrame,!1),this._mediaInfos=d,this._mediaPtr=0,this._updateUI(),this._displayMedia());b.editSummary&&(f.set(this._editSummary,"innerHTML",b.editSummary),d&&d.length&&v.remove(this._mediaBreak,"hidden"),v.remove(this._editSummarySection,"hidden"))}},_handleComponentsError:function(a){console.log("PopupRenderer: error loading template",a)}});r("extend-esri")&&l.setObject("dijit._PopupRenderer",n,F);return n})},
"dojox/html/entities":function(){define(["dojo/_base/lang"],function(m){var n=m.getObject("dojox.html.entities",!0),g=function(e,a){var l,b;if(a._encCache&&a._encCache.regexp&&a._encCache.mapper&&a.length==a._encCache.length)l=a._encCache.mapper,b=a._encCache.regexp;else{l={};b=["["];var k;for(k=0;k<a.length;k++)l[a[k][0]]="\x26"+a[k][1]+";",b.push(a[k][0]);b.push("]");b=new RegExp(b.join(""),"g");a._encCache={mapper:l,regexp:b,length:a.length}}return e=e.replace(b,function(a){return l[a]})},l=function(e,
a){var l,b;if(a._decCache&&a._decCache.regexp&&a._decCache.mapper&&a.length==a._decCache.length)l=a._decCache.mapper,b=a._decCache.regexp;else{l={};b=["("];var k;for(k=0;k<a.length;k++){var f="\x26"+a[k][1]+";";k&&b.push("|");l[f]=a[k][0];b.push(f)}b.push(")");b=new RegExp(b.join(""),"g");a._decCache={mapper:l,regexp:b,length:a.length}}return e=e.replace(b,function(a){return l[a]})};n.html=[["\x26","amp"],['"',"quot"],["\x3c","lt"],["\x3e","gt"],["\u00a0","nbsp"]];n.latin=[["\u00a1","iexcl"],["\u00a2",
"cent"],["\u00a3","pound"],["\u20ac","euro"],["\u00a4","curren"],["\u00a5","yen"],["\u00a6","brvbar"],["\u00a7","sect"],["\u00a8","uml"],["\u00a9","copy"],["\u00aa","ordf"],["\u00ab","laquo"],["\u00ac","not"],["\u00ad","shy"],["\u00ae","reg"],["\u00af","macr"],["\u00b0","deg"],["\u00b1","plusmn"],["\u00b2","sup2"],["\u00b3","sup3"],["\u00b4","acute"],["\u00b5","micro"],["\u00b6","para"],["\u00b7","middot"],["\u00b8","cedil"],["\u00b9","sup1"],["\u00ba","ordm"],["\u00bb","raquo"],["\u00bc","frac14"],
["\u00bd","frac12"],["\u00be","frac34"],["\u00bf","iquest"],["\u00c0","Agrave"],["\u00c1","Aacute"],["\u00c2","Acirc"],["\u00c3","Atilde"],["\u00c4","Auml"],["\u00c5","Aring"],["\u00c6","AElig"],["\u00c7","Ccedil"],["\u00c8","Egrave"],["\u00c9","Eacute"],["\u00ca","Ecirc"],["\u00cb","Euml"],["\u00cc","Igrave"],["\u00cd","Iacute"],["\u00ce","Icirc"],["\u00cf","Iuml"],["\u00d0","ETH"],["\u00d1","Ntilde"],["\u00d2","Ograve"],["\u00d3","Oacute"],["\u00d4","Ocirc"],["\u00d5","Otilde"],["\u00d6","Ouml"],
["\u00d7","times"],["\u00d8","Oslash"],["\u00d9","Ugrave"],["\u00da","Uacute"],["\u00db","Ucirc"],["\u00dc","Uuml"],["\u00dd","Yacute"],["\u00de","THORN"],["\u00df","szlig"],["\u00e0","agrave"],["\u00e1","aacute"],["\u00e2","acirc"],["\u00e3","atilde"],["\u00e4","auml"],["\u00e5","aring"],["\u00e6","aelig"],["\u00e7","ccedil"],["\u00e8","egrave"],["\u00e9","eacute"],["\u00ea","ecirc"],["\u00eb","euml"],["\u00ec","igrave"],["\u00ed","iacute"],["\u00ee","icirc"],["\u00ef","iuml"],["\u00f0","eth"],["\u00f1",
"ntilde"],["\u00f2","ograve"],["\u00f3","oacute"],["\u00f4","ocirc"],["\u00f5","otilde"],["\u00f6","ouml"],["\u00f7","divide"],["\u00f8","oslash"],["\u00f9","ugrave"],["\u00fa","uacute"],["\u00fb","ucirc"],["\u00fc","uuml"],["\u00fd","yacute"],["\u00fe","thorn"],["\u00ff","yuml"],["\u0192","fnof"],["\u0391","Alpha"],["\u0392","Beta"],["\u0393","Gamma"],["\u0394","Delta"],["\u0395","Epsilon"],["\u0396","Zeta"],["\u0397","Eta"],["\u0398","Theta"],["\u0399","Iota"],["\u039a","Kappa"],["\u039b","Lambda"],
["\u039c","Mu"],["\u039d","Nu"],["\u039e","Xi"],["\u039f","Omicron"],["\u03a0","Pi"],["\u03a1","Rho"],["\u03a3","Sigma"],["\u03a4","Tau"],["\u03a5","Upsilon"],["\u03a6","Phi"],["\u03a7","Chi"],["\u03a8","Psi"],["\u03a9","Omega"],["\u03b1","alpha"],["\u03b2","beta"],["\u03b3","gamma"],["\u03b4","delta"],["\u03b5","epsilon"],["\u03b6","zeta"],["\u03b7","eta"],["\u03b8","theta"],["\u03b9","iota"],["\u03ba","kappa"],["\u03bb","lambda"],["\u03bc","mu"],["\u03bd","nu"],["\u03be","xi"],["\u03bf","omicron"],
["\u03c0","pi"],["\u03c1","rho"],["\u03c2","sigmaf"],["\u03c3","sigma"],["\u03c4","tau"],["\u03c5","upsilon"],["\u03c6","phi"],["\u03c7","chi"],["\u03c8","psi"],["\u03c9","omega"],["\u03d1","thetasym"],["\u03d2","upsih"],["\u03d6","piv"],["\u2022","bull"],["\u2026","hellip"],["\u2032","prime"],["\u2033","Prime"],["\u203e","oline"],["\u2044","frasl"],["\u2118","weierp"],["\u2111","image"],["\u211c","real"],["\u2122","trade"],["\u2135","alefsym"],["\u2190","larr"],["\u2191","uarr"],["\u2192","rarr"],
["\u2193","darr"],["\u2194","harr"],["\u21b5","crarr"],["\u21d0","lArr"],["\u21d1","uArr"],["\u21d2","rArr"],["\u21d3","dArr"],["\u21d4","hArr"],["\u2200","forall"],["\u2202","part"],["\u2203","exist"],["\u2205","empty"],["\u2207","nabla"],["\u2208","isin"],["\u2209","notin"],["\u220b","ni"],["\u220f","prod"],["\u2211","sum"],["\u2212","minus"],["\u2217","lowast"],["\u221a","radic"],["\u221d","prop"],["\u221e","infin"],["\u2220","ang"],["\u2227","and"],["\u2228","or"],["\u2229","cap"],["\u222a","cup"],
["\u222b","int"],["\u2234","there4"],["\u223c","sim"],["\u2245","cong"],["\u2248","asymp"],["\u2260","ne"],["\u2261","equiv"],["\u2264","le"],["\u2265","ge"],["\u2282","sub"],["\u2283","sup"],["\u2284","nsub"],["\u2286","sube"],["\u2287","supe"],["\u2295","oplus"],["\u2297","otimes"],["\u22a5","perp"],["\u22c5","sdot"],["\u2308","lceil"],["\u2309","rceil"],["\u230a","lfloor"],["\u230b","rfloor"],["\u2329","lang"],["\u232a","rang"],["\u25ca","loz"],["\u2660","spades"],["\u2663","clubs"],["\u2665",
"hearts"],["\u2666","diams"],["\u0152","OElig"],["\u0153","oelig"],["\u0160","Scaron"],["\u0161","scaron"],["\u0178","Yuml"],["\u02c6","circ"],["\u02dc","tilde"],["\u2002","ensp"],["\u2003","emsp"],["\u2009","thinsp"],["\u200c","zwnj"],["\u200d","zwj"],["\u200e","lrm"],["\u200f","rlm"],["\u2013","ndash"],["\u2014","mdash"],["\u2018","lsquo"],["\u2019","rsquo"],["\u201a","sbquo"],["\u201c","ldquo"],["\u201d","rdquo"],["\u201e","bdquo"],["\u2020","dagger"],["\u2021","Dagger"],["\u2030","permil"],["\u2039",
"lsaquo"],["\u203a","rsaquo"]];n.encode=function(e,a){e&&(a?e=g(e,a):(e=g(e,n.html),e=g(e,n.latin)));return e};n.decode=function(e,a){e&&(a?e=l(e,a):(e=l(e,n.html),e=l(e,n.latin)));return e};return n})},"dijit/_Widget":function(){define("dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/has dojo/_base/kernel dojo/_base/lang dojo/query dojo/ready ./registry ./_WidgetBase ./_OnDijitClickMixin ./_FocusMixin dojo/uacss ./hccss".split(" "),function(m,n,g,l,e,a,r,b,k,f,v,A,E){function x(){}
function z(a){return function(b,f,e,l){return b&&"string"==typeof f&&b[f]==x?b.on(f.substring(2).toLowerCase(),r.hitch(e,l)):a.apply(g,arguments)}}m.around(g,"connect",z);a.connect&&m.around(a,"connect",z);m=l("dijit._Widget",[v,A,E],{onClick:x,onDblClick:x,onKeyDown:x,onKeyPress:x,onKeyUp:x,onMouseDown:x,onMouseMove:x,onMouseOut:x,onMouseOver:x,onMouseLeave:x,onMouseEnter:x,onMouseUp:x,constructor:function(a){this._toConnect={};for(var b in a)this[b]===x&&(this._toConnect[b.replace(/^on/,"").toLowerCase()]=
a[b],delete a[b])},postCreate:function(){this.inherited(arguments);for(var a in this._toConnect)this.on(a,this._toConnect[a]);delete this._toConnect},on:function(a,b){return this[this._onMap(a)]===x?g.connect(this.domNode,a.toLowerCase(),this,b):this.inherited(arguments)},_setFocusedAttr:function(a){this._focused=a;this._set("focused",a)},setAttribute:function(b,f){a.deprecated(this.declaredClass+"::setAttribute(attr, value) is deprecated. Use set() instead.","","2.0");this.set(b,f)},attr:function(a,
b){return 2<=arguments.length||"object"===typeof a?this.set.apply(this,arguments):this.get(a)},getDescendants:function(){a.deprecated(this.declaredClass+"::getDescendants() is deprecated. Use getChildren() instead.","","2.0");return this.containerNode?b("[widgetId]",this.containerNode).map(f.byNode):[]},_onShow:function(){this.onShow()},onShow:function(){},onHide:function(){},onClose:function(){return!0}});e("dijit-legacy-requires")&&k(0,function(){require(["dijit/_base"])});return m})},"dijit/_WidgetBase":function(){define("require dojo/_base/array dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/_base/kernel dojo/_base/lang dojo/on dojo/ready dojo/Stateful dojo/topic dojo/_base/window ./Destroyable dojo/has!dojo-bidi?./_BidiMixin ./registry".split(" "),
function(m,n,g,l,e,a,r,b,k,f,v,A,E,x,z,D,F,y,B,I,J,q,p){function t(d){return function(c){b[c?"set":"remove"](this.domNode,d,c);this._set(d,c)}}E.add("dijit-legacy-requires",!x.isAsync);E.add("dojo-bidi",!1);E("dijit-legacy-requires")&&F(0,function(){m(["dijit/_base/manager"])});var h={};l=a("dijit._WidgetBase",[y,J],{id:"",_setIdAttr:"domNode",lang:"",_setLangAttr:t("lang"),dir:"",_setDirAttr:t("dir"),"class":"",_setClassAttr:{node:"domNode",type:"class"},_setTypeAttr:null,style:"",title:"",tooltip:"",
baseClass:"",srcNodeRef:null,domNode:null,containerNode:null,ownerDocument:null,_setOwnerDocumentAttr:function(d){this._set("ownerDocument",d)},attributeMap:{},_blankGif:l.blankGif||m.toUrl("dojo/resources/blank.gif"),textDir:"",_introspect:function(){var d=this.constructor;if(!d._setterAttrs){var c=d.prototype,a=d._setterAttrs=[],d=d._onMap={},b;for(b in c.attributeMap)a.push(b);for(b in c)/^on/.test(b)&&(d[b.substring(2).toLowerCase()]=b),/^_set[A-Z](.*)Attr$/.test(b)&&(b=b.charAt(4).toLowerCase()+
b.substr(5,b.length-9),c.attributeMap&&b in c.attributeMap||a.push(b))}},postscript:function(d,c){this.create(d,c)},create:function(d,c){this._introspect();this.srcNodeRef=r.byId(c);this._connects=[];this._supportingWidgets=[];this.srcNodeRef&&this.srcNodeRef.id&&"string"==typeof this.srcNodeRef.id&&(this.id=this.srcNodeRef.id);d&&(this.params=d,z.mixin(this,d));this.postMixInProperties();this.id||(this.id=p.getUniqueId(this.declaredClass.replace(/\./g,"_")),this.params&&delete this.params.id);this.ownerDocument=
this.ownerDocument||(this.srcNodeRef?this.srcNodeRef.ownerDocument:document);this.ownerDocumentBody=I.body(this.ownerDocument);p.add(this);this.buildRendering();var a;if(this.domNode){this._applyAttributes();var b=this.srcNodeRef;b&&b.parentNode&&this.domNode!==b&&(b.parentNode.replaceChild(this.domNode,b),a=!0);this.domNode.setAttribute("widgetId",this.id)}this.postCreate();a&&delete this.srcNodeRef;this._created=!0},_applyAttributes:function(){var d={},c;for(c in this.params||{})d[c]=this._get(c);
n.forEach(this.constructor._setterAttrs,function(c){if(!(c in d)){var a=this._get(c);a&&this.set(c,a)}},this);for(c in d)this.set(c,d[c])},postMixInProperties:function(){},buildRendering:function(){this.domNode||(this.domNode=this.srcNodeRef||this.ownerDocument.createElement("div"));if(this.baseClass){var d=this.baseClass.split(" ");this.isLeftToRight()||(d=d.concat(n.map(d,function(c){return c+"Rtl"})));k.add(this.domNode,d)}},postCreate:function(){},startup:function(){this._started||(this._started=
!0,n.forEach(this.getChildren(),function(d){d._started||d._destroyed||!z.isFunction(d.startup)||(d.startup(),d._started=!0)}))},destroyRecursive:function(d){this._beingDestroyed=!0;this.destroyDescendants(d);this.destroy(d)},destroy:function(d){function c(c){c.destroyRecursive?c.destroyRecursive(d):c.destroy&&c.destroy(d)}this._beingDestroyed=!0;this.uninitialize();n.forEach(this._connects,z.hitch(this,"disconnect"));n.forEach(this._supportingWidgets,c);this.domNode&&n.forEach(p.findWidgets(this.domNode,
this.containerNode),c);this.destroyRendering(d);p.remove(this.id);this._destroyed=!0},destroyRendering:function(d){this.bgIframe&&(this.bgIframe.destroy(d),delete this.bgIframe);this.domNode&&(d?b.remove(this.domNode,"widgetId"):f.destroy(this.domNode),delete this.domNode);this.srcNodeRef&&(d||f.destroy(this.srcNodeRef),delete this.srcNodeRef)},destroyDescendants:function(d){n.forEach(this.getChildren(),function(c){c.destroyRecursive&&c.destroyRecursive(d)})},uninitialize:function(){return!1},_setStyleAttr:function(d){var c=
this.domNode;z.isObject(d)?A.set(c,d):c.style.cssText=c.style.cssText?c.style.cssText+("; "+d):d;this._set("style",d)},_attrToDom:function(d,c,a){a=3<=arguments.length?a:this.attributeMap[d];n.forEach(z.isArray(a)?a:[a],function(a){var h=this[a.node||a||"domNode"];switch(a.type||"attribute"){case "attribute":z.isFunction(c)&&(c=z.hitch(this,c));a=a.attribute?a.attribute:/^on[A-Z][a-zA-Z]*$/.test(d)?d.toLowerCase():d;h.tagName?b.set(h,a,c):h.set(a,c);break;case "innerText":h.innerHTML="";h.appendChild(this.ownerDocument.createTextNode(c));
break;case "innerHTML":h.innerHTML=c;break;case "class":k.replace(h,c,this[d]);break;case "toggleClass":k.toggle(h,a.className||d,c)}},this)},get:function(a){var c=this._getAttrNames(a);return this[c.g]?this[c.g]():this._get(a)},set:function(a,c){if("object"===typeof a){for(var d in a)this.set(d,a[d]);return this}d=this._getAttrNames(a);var b=this[d.s];if(z.isFunction(b))var f=b.apply(this,Array.prototype.slice.call(arguments,1));else{var b=this.focusNode&&!z.isFunction(this.focusNode)?"focusNode":
"domNode",e=this[b]&&this[b].tagName,p;if((p=e)&&!(p=h[e])){p=this[b];var q={},l;for(l in p)q[l.toLowerCase()]=!0;p=h[e]=q}l=p;d=a in this.attributeMap?this.attributeMap[a]:d.s in this?this[d.s]:l&&d.l in l&&"function"!=typeof c||/^aria-|^data-|^role$/.test(a)?b:null;null!=d&&this._attrToDom(a,c,d);this._set(a,c)}return f||this},_attrPairNames:{},_getAttrNames:function(a){var c=this._attrPairNames;if(c[a])return c[a];var d=a.replace(/^[a-z]|-[a-zA-Z]/g,function(a){return a.charAt(a.length-1).toUpperCase()});
return c[a]={n:a+"Node",s:"_set"+d+"Attr",g:"_get"+d+"Attr",l:d.toLowerCase()}},_set:function(a,c){var d=this[a];this[a]=c;!this._created||d===c||d!==d&&c!==c||(this._watchCallbacks&&this._watchCallbacks(a,d,c),this.emit("attrmodified-"+a,{detail:{prevValue:d,newValue:c}}))},_get:function(a){return this[a]},emit:function(a,c,b){c=c||{};void 0===c.bubbles&&(c.bubbles=!0);void 0===c.cancelable&&(c.cancelable=!0);c.detail||(c.detail={});c.detail.widget=this;var d,h=this["on"+a];h&&(d=h.apply(this,b?
b:[c]));this._started&&!this._beingDestroyed&&D.emit(this.domNode,a.toLowerCase(),c);return d},on:function(a,c){var d=this._onMap(a);return d?g.after(this,d,c,!0):this.own(D(this.domNode,a,c))[0]},_onMap:function(a){var c=this.constructor,d=c._onMap;if(!d){var d=c._onMap={},b;for(b in c.prototype)/^on/.test(b)&&(d[b.replace(/^on/,"").toLowerCase()]=b)}return d["string"==typeof a&&a.toLowerCase()]},toString:function(){return"[Widget "+this.declaredClass+", "+(this.id||"NO ID")+"]"},getChildren:function(){return this.containerNode?
p.findWidgets(this.containerNode):[]},getParent:function(){return p.getEnclosingWidget(this.domNode.parentNode)},connect:function(a,c,b){return this.own(e.connect(a,c,this,b))[0]},disconnect:function(a){a.remove()},subscribe:function(a,c){return this.own(B.subscribe(a,z.hitch(this,c)))[0]},unsubscribe:function(a){a.remove()},isLeftToRight:function(){return this.dir?"ltr"==this.dir.toLowerCase():v.isBodyLtr(this.ownerDocument)},isFocusable:function(){return this.focus&&"none"!=A.get(this.domNode,"display")},
placeAt:function(a,c){var d=!a.tagName&&p.byId(a);!d||!d.addChild||c&&"number"!==typeof c?(d=d&&"domNode"in d?d.containerNode&&!/after|before|replace/.test(c||"")?d.containerNode:d.domNode:r.byId(a,this.ownerDocument),f.place(this.domNode,d,c),!this._started&&(this.getParent()||{})._started&&this.startup()):d.addChild(this,c);return this},defer:function(a,c){var d=setTimeout(z.hitch(this,function(){d&&(d=null,this._destroyed||z.hitch(this,a)())}),c||0);return{remove:function(){d&&(clearTimeout(d),
d=null);return null}}}});E("dojo-bidi")&&l.extend(q);return l})},"dijit/Destroyable":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare"],function(m,n,g){return g("dijit.Destroyable",null,{destroy:function(l){this._destroyed=!0},own:function(){var l=["destroyRecursive","destroy","remove"];m.forEach(arguments,function(e){function a(){b.remove();m.forEach(k,function(a){a.remove()})}var g,b=n.before(this,"destroy",function(a){e[g](a)}),k=[];e.then?(g="cancel",e.then(a,a)):m.forEach(l,
function(b){"function"===typeof e[b]&&(g||(g=b),k.push(n.after(e,b,a,!0)))})},this);return arguments}})})},"dijit/_OnDijitClickMixin":function(){define("dojo/on dojo/_base/array dojo/keys dojo/_base/declare dojo/has ./a11yclick".split(" "),function(m,n,g,l,e,a){m=l("dijit._OnDijitClickMixin",null,{connect:function(e,b,l){return this.inherited(arguments,[e,"ondijitclick"==b?a:b,l])}});m.a11yclick=a;return m})},"dijit/_FocusMixin":function(){define(["./focus","./_WidgetBase","dojo/_base/declare","dojo/_base/lang"],
function(m,n,g,l){l.extend(n,{focused:!1,onFocus:function(){},onBlur:function(){},_onFocus:function(){this.onFocus()},_onBlur:function(){this.onBlur()}});return g("dijit._FocusMixin",null,{_focusManager:m})})},"dijit/hccss":function(){define(["dojo/dom-class","dojo/hccss","dojo/domReady","dojo/_base/window"],function(m,n,g,l){g(function(){n("highcontrast")&&m.add(l.body(),"dijit_a11y")});return n})},"dojo/hccss":function(){define("require ./_base/config ./dom-class ./dom-style ./has ./domReady ./_base/window".split(" "),
function(m,n,g,l,e,a,r){e.add("highcontrast",function(){var a=r.doc.createElement("div");try{a.style.cssText='border: 1px solid; border-color:red green; position: absolute; height: 5px; top: -999px;background-image: url("'+(n.blankGif||m.toUrl("./resources/blank.gif"))+'");';r.body().appendChild(a);var k=l.getComputedStyle(a),f=k.backgroundImage;return k.borderTopColor==k.borderRightColor||f&&("none"==f||"url(invalid-url:)"==f)}catch(v){return console.warn("hccss: exception detecting high-contrast mode, document is likely hidden: "+
v.toString()),!1}finally{8>=e("ie")?a.outerHTML="":r.body().removeChild(a)}});a(function(){e("highcontrast")&&g.add(r.body(),"dj_a11y")});return e})},"dijit/_Templated":function(){define("./_WidgetBase ./_TemplatedMixin ./_WidgetsInTemplateMixin dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/_base/kernel".split(" "),function(m,n,g,l,e,a,r){a.extend(m,{waiRole:"",waiState:""});return e("dijit._Templated",[n,g],{constructor:function(){r.deprecated(this.declaredClass+": dijit._Templated deprecated, use dijit._TemplatedMixin and if necessary dijit._WidgetsInTemplateMixin",
"","2.0")},_processNode:function(a,e){var b=this.inherited(arguments),k=e(a,"waiRole");k&&a.setAttribute("role",k);(k=e(a,"waiState"))&&l.forEach(k.split(/\s*,\s*/),function(b){-1!=b.indexOf("-")&&(b=b.split("-"),a.setAttribute("aria-"+b[0],b[1]))});return b}})})},"dijit/_TemplatedMixin":function(){define("dojo/cache dojo/_base/declare dojo/dom-construct dojo/_base/lang dojo/on dojo/sniff dojo/string ./_AttachMixin".split(" "),function(m,n,g,l,e,a,r,b){var k=n("dijit._TemplatedMixin",b,{templateString:null,
templatePath:null,_skipNodeCache:!1,searchContainerNode:!0,_stringRepl:function(a){var b=this.declaredClass,e=this;return r.substitute(a,this,function(a,f){"!"==f.charAt(0)&&(a=l.getObject(f.substr(1),!1,e));if("undefined"==typeof a)throw Error(b+" template:"+f);return null==a?"":"!"==f.charAt(0)?a:this._escapeValue(""+a)},this)},_escapeValue:function(a){return a.replace(/["'<>&]/g,function(a){return{"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;"}[a]})},buildRendering:function(){if(!this._rendered){this.templateString||
(this.templateString=m(this.templatePath,{sanitize:!0}));var a=k.getCachedTemplate(this.templateString,this._skipNodeCache,this.ownerDocument),b;if(l.isString(a)){if(b=g.toDom(this._stringRepl(a),this.ownerDocument),1!=b.nodeType)throw Error("Invalid template: "+a);}else b=a.cloneNode(!0);this.domNode=b}this.inherited(arguments);this._rendered||this._fillContent(this.srcNodeRef);this._rendered=!0},_fillContent:function(a){var b=this.containerNode;if(a&&b)for(;a.hasChildNodes();)b.appendChild(a.firstChild)}});
k._templateCache={};k.getCachedTemplate=function(a,b,e){var f=k._templateCache,l=a,n=f[l];if(n){try{if(!n.ownerDocument||n.ownerDocument==(e||document))return n}catch(D){}g.destroy(n)}a=r.trim(a);if(b||a.match(/\$\{([^\}]+)\}/g))return f[l]=a;b=g.toDom(a,e);if(1!=b.nodeType)throw Error("Invalid template: "+a);return f[l]=b};a("ie")&&e(window,"unload",function(){var a=k._templateCache,b;for(b in a){var e=a[b];"object"==typeof e&&g.destroy(e);delete a[b]}});return k})},"dojo/cache":function(){define(["./_base/kernel",
"./text"],function(m){return m.cache})},"dijit/_AttachMixin":function(){define("require dojo/_base/array dojo/_base/connect dojo/_base/declare dojo/_base/lang dojo/mouse dojo/on dojo/touch ./_WidgetBase".split(" "),function(m,n,g,l,e,a,r,b,k){var f=e.delegate(b,{mouseenter:a.enter,mouseleave:a.leave,keypress:g._keypress}),v;g=l("dijit._AttachMixin",null,{constructor:function(){this._attachPoints=[];this._attachEvents=[]},buildRendering:function(){this.inherited(arguments);this._attachTemplateNodes(this.domNode);
this._beforeFillContent()},_beforeFillContent:function(){},_attachTemplateNodes:function(a){for(var b=a;;)if(1==b.nodeType&&(this._processTemplateNode(b,function(a,b){return a.getAttribute(b)},this._attach)||this.searchContainerNode)&&b.firstChild)b=b.firstChild;else{if(b==a)break;for(;!b.nextSibling;)if(b=b.parentNode,b==a)return;b=b.nextSibling}},_processTemplateNode:function(a,b,f){var l=!0,k=this.attachScope||this,n=b(a,"dojoAttachPoint")||b(a,"data-dojo-attach-point");if(n)for(var g=n.split(/\s*,\s*/);n=
g.shift();)e.isArray(k[n])?k[n].push(a):k[n]=a,l="containerNode"!=n,this._attachPoints.push(n);if(b=b(a,"dojoAttachEvent")||b(a,"data-dojo-attach-event"))for(n=b.split(/\s*,\s*/),g=e.trim;b=n.shift();)if(b){var m=null;-1!=b.indexOf(":")?(m=b.split(":"),b=g(m[0]),m=g(m[1])):b=g(b);m||(m=b);this._attachEvents.push(f(a,b,e.hitch(k,m)))}return l},_attach:function(a,b,e){b=b.replace(/^on/,"").toLowerCase();b="dijitclick"==b?v||(v=m("./a11yclick")):f[b]||b;return r(a,b,e)},_detachTemplateNodes:function(){var a=
this.attachScope||this;n.forEach(this._attachPoints,function(b){delete a[b]});this._attachPoints=[];n.forEach(this._attachEvents,function(a){a.remove()});this._attachEvents=[]},destroyRendering:function(){this._detachTemplateNodes();this.inherited(arguments)}});e.extend(k,{dojoAttachEvent:"",dojoAttachPoint:""});return g})},"dijit/_WidgetsInTemplateMixin":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang","dojo/parser"],function(m,n,g,l,e){return g("dijit._WidgetsInTemplateMixin",
null,{_earlyTemplatedStartup:!1,contextRequire:null,_beforeFillContent:function(){if(/dojoType|data-dojo-type/i.test(this.domNode.innerHTML)){var a=this.domNode;this.containerNode&&!this.searchContainerNode&&(this.containerNode.stopParser=!0);e.parse(a,{noStart:!this._earlyTemplatedStartup,template:!0,inherited:{dir:this.dir,lang:this.lang,textDir:this.textDir},propsThis:this,contextRequire:this.contextRequire,scope:"dojo"}).then(l.hitch(this,function(a){this._startupWidgets=a;for(var b=0;b<a.length;b++)this._processTemplateNode(a[b],
function(a,b){return a[b]},function(a,b,e){return b in a?a.connect(a,b,e):a.on(b,e,!0)});this.containerNode&&this.containerNode.stopParser&&delete this.containerNode.stopParser}));if(!this._startupWidgets)throw Error(this.declaredClass+": parser returned unfilled promise (probably waiting for module auto-load), unsupported by _WidgetsInTemplateMixin.   Must pre-load all supporting widgets before instantiation.");}},_processTemplateNode:function(a,e,b){return e(a,"dojoType")||e(a,"data-dojo-type")?
!0:this.inherited(arguments)},startup:function(){m.forEach(this._startupWidgets,function(a){a&&!a._started&&a.startup&&a.startup()});this._startupWidgets=null;this.inherited(arguments)}})})},"dojo/parser":function(){define("require ./_base/kernel ./_base/lang ./_base/array ./_base/config ./dom ./_base/window ./_base/url ./aspect ./promise/all ./date/stamp ./Deferred ./has ./query ./on ./ready".split(" "),function(m,n,g,l,e,a,r,b,k,f,v,A,E,x,z,D){function F(a){return eval("("+a+")")}function y(a){var b=
a._nameCaseMap,e=a.prototype;if(!b||b._extendCnt<I){var b=a._nameCaseMap={},h;for(h in e)"_"!==h.charAt(0)&&(b[h.toLowerCase()]=h);b._extendCnt=I}return b}function B(a,b){b||(b=m);var e=b._dojoParserCtorMap||(b._dojoParserCtorMap={}),h=a.join();if(!e[h]){for(var d=[],c=0,f=a.length;c<f;c++){var p=a[c];d[d.length]=e[p]=e[p]||g.getObject(p)||~p.indexOf("/")&&b(p)}c=d.shift();e[h]=d.length?c.createSubclass?c.createSubclass(d):c.extend.apply(c,d):c}return e[h]}new Date("X");var I=0;k.after(g,"extend",
function(){I++},!0);var J={_clearCache:function(){I++;_ctorMap={}},_functionFromScript:function(a,b){var e="",h="",d=a.getAttribute(b+"args")||a.getAttribute("args"),c=a.getAttribute("with"),d=(d||"").split(/\s*,\s*/);c&&c.length&&l.forEach(c.split(/\s*,\s*/),function(a){e+="with("+a+"){";h+="}"});return new Function(d,e+a.innerHTML+h)},instantiate:function(a,b,e){b=b||{};e=e||{};var h=(e.scope||n._scopeName)+"Type",d="data-"+(e.scope||n._scopeName)+"-",c=d+"type",f=d+"mixins",p=[];l.forEach(a,function(a){var d=
h in b?b[h]:a.getAttribute(c)||a.getAttribute(h);if(d){var e=a.getAttribute(f),d=e?[d].concat(e.split(/\s*,\s*/)):[d];p.push({node:a,types:d})}});return this._instantiate(p,b,e)},_instantiate:function(a,b,e,h){function d(a){b._started||e.noStart||l.forEach(a,function(a){"function"!==typeof a.startup||a._started||a.startup()});return a}a=l.map(a,function(a){var c=a.ctor||B(a.types,e.contextRequire);if(!c)throw Error("Unable to resolve constructor for: '"+a.types.join()+"'");return this.construct(c,
a.node,b,e,a.scripts,a.inherited)},this);return h?f(a).then(d):d(a)},construct:function(a,e,f,h,d,c){function p(a){A&&g.setObject(A,a);for(r=0;r<D.length;r++)k[D[r].advice||"after"](a,D[r].method,g.hitch(a,D[r].func),!0);for(r=0;r<L.length;r++)L[r].call(a);for(r=0;r<M.length;r++)a.watch(M[r].prop,M[r].func);for(r=0;r<N.length;r++)z(a,N[r].event,N[r].func);return a}var w=a&&a.prototype;h=h||{};var q={};h.defaults&&g.mixin(q,h.defaults);c&&g.mixin(q,c);var m;E("dom-attributes-explicit")?m=e.attributes:
E("dom-attributes-specified-flag")?m=l.filter(e.attributes,function(a){return a.specified}):(c=(/^input$|^img$/i.test(e.nodeName)?e:e.cloneNode(!1)).outerHTML.replace(/=[^\s"']+|="[^"]*"|='[^']*'/g,"").replace(/^\s*<[a-zA-Z0-9]*\s*/,"").replace(/\s*>.*$/,""),m=l.map(c.split(/\s+/),function(a){var b=a.toLowerCase();return{name:a,value:"LI"==e.nodeName&&"value"==a||"enctype"==b?e.getAttribute(b):e.getAttributeNode(b).value}}));var G=h.scope||n._scopeName;c="data-"+G+"-";var C={};"dojo"!==G&&(C[c+"props"]=
"data-dojo-props",C[c+"type"]="data-dojo-type",C[c+"mixins"]="data-dojo-mixins",C[G+"type"]="dojotype",C[c+"id"]="data-dojo-id");for(var r=0,t,G=[],A,K;t=m[r++];){var H=t.name,B=H.toLowerCase();t=t.value;switch(C[B]||B){case "data-dojo-type":case "dojotype":case "data-dojo-mixins":break;case "data-dojo-props":K=t;break;case "data-dojo-id":case "jsid":A=t;break;case "data-dojo-attach-point":case "dojoattachpoint":q.dojoAttachPoint=t;break;case "data-dojo-attach-event":case "dojoattachevent":q.dojoAttachEvent=
t;break;case "class":q["class"]=e.className;break;case "style":q.style=e.style&&e.style.cssText;break;default:if(H in w||(H=y(a)[B]||H),H in w)switch(typeof w[H]){case "string":q[H]=t;break;case "number":q[H]=t.length?Number(t):NaN;break;case "boolean":q[H]="false"!=t.toLowerCase();break;case "function":""===t||-1!=t.search(/[^\w\.]+/i)?q[H]=new Function(t):q[H]=g.getObject(t,!1)||new Function(t);G.push(H);break;default:B=w[H],q[H]=B&&"length"in B?t?t.split(/\s*,\s*/):[]:B instanceof Date?""==t?new Date(""):
"now"==t?new Date:v.fromISOString(t):B instanceof b?n.baseUrl+t:F(t)}else q[H]=t}}for(m=0;m<G.length;m++)C=G[m].toLowerCase(),e.removeAttribute(C),e[C]=null;if(K)try{K=F.call(h.propsThis,"{"+K+"}"),g.mixin(q,K)}catch(O){throw Error(O.toString()+" in data-dojo-props\x3d'"+K+"'");}g.mixin(q,f);d||(d=a&&(a._noScript||w._noScript)?[]:x("\x3e script[type^\x3d'dojo/']",e));var D=[],L=[],M=[],N=[];if(d)for(r=0;r<d.length;r++)C=d[r],e.removeChild(C),f=C.getAttribute(c+"event")||C.getAttribute("event"),h=
C.getAttribute(c+"prop"),K=C.getAttribute(c+"method"),G=C.getAttribute(c+"advice"),m=C.getAttribute("type"),C=this._functionFromScript(C,c),f?"dojo/connect"==m?D.push({method:f,func:C}):"dojo/on"==m?N.push({event:f,func:C}):q[f]=C:"dojo/aspect"==m?D.push({method:K,advice:G,func:C}):"dojo/watch"==m?M.push({prop:h,func:C}):L.push(C);a=(d=a.markupFactory||w.markupFactory)?d(q,e,a):new a(q,e);return a.then?a.then(p):p(a)},scan:function(a,b){function e(a){if(!a.inherited){a.inherited={};var b=a.node,c=
e(a.parent),b={dir:b.getAttribute("dir")||c.dir,lang:b.getAttribute("lang")||c.lang,textDir:b.getAttribute(q)||c.textDir},d;for(d in b)b[d]&&(a.inherited[d]=b[d])}return a.inherited}var h=[],d=[],c={},f=(b.scope||n._scopeName)+"Type",w="data-"+(b.scope||n._scopeName)+"-",p=w+"type",q=w+"textdir",w=w+"mixins",k=a.firstChild,g=b.inherited;if(!g){var r=function(a,b){return a.getAttribute&&a.getAttribute(b)||a.parentNode&&r(a.parentNode,b)},g={dir:r(a,"dir"),lang:r(a,"lang"),textDir:r(a,q)},v;for(v in g)g[v]||
delete g[v]}for(var g={inherited:g},x,y;;)if(k)if(1!=k.nodeType)k=k.nextSibling;else if(x&&"script"==k.nodeName.toLowerCase())(z=k.getAttribute("type"))&&/^dojo\/\w/i.test(z)&&x.push(k),k=k.nextSibling;else if(y)k=k.nextSibling;else{var z=k.getAttribute(p)||k.getAttribute(f);v=k.firstChild;if(z||v&&(3!=v.nodeType||v.nextSibling)){y=null;if(z){var D=k.getAttribute(w);x=D?[z].concat(D.split(/\s*,\s*/)):[z];try{y=B(x,b.contextRequire)}catch(L){}y||l.forEach(x,function(a){~a.indexOf("/")&&!c[a]&&(c[a]=
!0,d[d.length]=a)});D=y&&!y.prototype._noScript?[]:null;g={types:x,ctor:y,parent:g,node:k,scripts:D};g.inherited=e(g);h.push(g)}else g={node:k,scripts:x,parent:g};x=D;y=k.stopParser||y&&y.prototype.stopParser&&!b.template;k=v}else k=k.nextSibling}else{if(!g||!g.node)break;k=g.node.nextSibling;y=!1;g=g.parent;x=g.scripts}var F=new A;d.length?(E("dojo-debug-messages")&&console.warn("WARNING: Modules being Auto-Required: "+d.join(", ")),(b.contextRequire||m)(d,function(){F.resolve(l.filter(h,function(a){if(!a.ctor)try{a.ctor=
B(a.types,b.contextRequire)}catch(O){}for(var c=a.parent;c&&!c.types;)c=c.parent;var d=a.ctor&&a.ctor.prototype;a.instantiateChildren=!(d&&d.stopParser&&!b.template);a.instantiate=!c||c.instantiate&&c.instantiateChildren;return a.instantiate}))})):F.resolve(h);return F.promise},_require:function(a,b){var e=F("{"+a.innerHTML+"}"),h=[],d=[],c=new A,f=b&&b.contextRequire||m,l;for(l in e)h.push(l),d.push(e[l]);f(d,function(){for(var a=0;a<h.length;a++)g.setObject(h[a],arguments[a]);c.resolve(arguments)});
return c.promise},_scanAmd:function(a,b){var e=new A,h=e.promise;e.resolve(!0);var d=this;x("script[type\x3d'dojo/require']",a).forEach(function(a){h=h.then(function(){return d._require(a,b)});a.parentNode.removeChild(a)});return h},parse:function(b,e){!b||"string"==typeof b||"nodeType"in b||(e=b,b=e.rootNode);var f=b?a.byId(b):r.body();e=e||{};var h=e.template?{template:!0}:{},d=[],c=this,l=this._scanAmd(f,e).then(function(){return c.scan(f,e)}).then(function(a){return c._instantiate(a,h,e,!0)}).then(function(a){return d=
d.concat(a)}).otherwise(function(a){console.error("dojo/parser::parse() error",a);throw a;});g.mixin(d,l);return d}};n.parser=J;e.parseOnLoad&&D(100,J,"parse");return J})},"dojo/date/stamp":function(){define(["../_base/lang","../_base/array"],function(m,n){var g={};m.setObject("dojo.date.stamp",g);g.fromISOString=function(l,e){g._isoRegExp||(g._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/);var a=g._isoRegExp.exec(l),m=null;
if(a){a.shift();a[1]&&a[1]--;a[6]&&(a[6]*=1E3);e&&(e=new Date(e),n.forEach(n.map("FullYear Month Date Hours Minutes Seconds Milliseconds".split(" "),function(a){return e["get"+a]()}),function(b,e){a[e]=a[e]||b}));m=new Date(a[0]||1970,a[1]||0,a[2]||1,a[3]||0,a[4]||0,a[5]||0,a[6]||0);100>a[0]&&m.setFullYear(a[0]||1970);var b=0,k=a[7]&&a[7].charAt(0);"Z"!=k&&(b=60*(a[8]||0)+(Number(a[9])||0),"-"!=k&&(b*=-1));k&&(b-=m.getTimezoneOffset());b&&m.setTime(m.getTime()+6E4*b)}return m};g.toISOString=function(l,
e){var a=function(a){return 10>a?"0"+a:a};e=e||{};var g=[],b=e.zulu?"getUTC":"get",k="";"time"!=e.selector&&(k=l[b+"FullYear"](),k=["0000".substr((k+"").length)+k,a(l[b+"Month"]()+1),a(l[b+"Date"]())].join("-"));g.push(k);if("date"!=e.selector){k=[a(l[b+"Hours"]()),a(l[b+"Minutes"]()),a(l[b+"Seconds"]())].join(":");b=l[b+"Milliseconds"]();e.milliseconds&&(k+="."+(100>b?"0":"")+a(b));if(e.zulu)k+="Z";else if("time"!=e.selector)var b=l.getTimezoneOffset(),f=Math.abs(b),k=k+((0<b?"-":"+")+a(Math.floor(f/
60))+":"+a(f%60));g.push(k)}return g.join("T")};return g})},"esri/dijit/_EventedWidget":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/on ../Evented dijit/_WidgetBase".split(" "),function(m,n,g,l,e,a){return m([a,e],{_onMap:function(a){var b=this.constructor._onMap,e;b&&b.FINAL||(delete this.constructor._onMap,b=this.registerConnectEvents(),b.FINAL=!0);a=a.toLowerCase();b[a]?e=this[b[a].method]:(a=this._onCamelCase(a),this[a]&&(e=a));return e},on:function(a,b){var e=this._onMap(a),
f=a.replace(/\-/g,""),g="on"+f in this.domNode;return e||!g?this.inherited(arguments):this.own(l(this.domNode,f,b))[0]},emit:function(a,b,e){var f,l,g,k=a.toLowerCase(),m=this.constructor._onMap||this.registerConnectEvents();l=this[this._onMap(k)];b=b||{};b.target||(b.target=this);l&&m&&m[k]&&(this._onObj2Arr(function(){f=Array.prototype.slice.call(arguments)},m[k].argKeys)(b),g=n.mixin({},arguments),g[2]=f,g[0]=m[k].name.replace(/^on/,""));return this.inherited(g||arguments)}})})},"esri/layers/KMLFolder":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel","../lang"],function(m,n,g,l,e){m=m(null,{declaredClass:"esri.layers.KMLFolder",constructor:function(a){n.mixin(this,a);e.isDefined(this.visibility)&&(this.visible=!!this.visibility)}});g("extend-esri")&&n.setObject("layers.KMLFolder",m,l);return m})},"esri/layers/KMLGroundOverlay":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./MapImage".split(" "),function(m,n,g,l,e,a){m=m([a],{declaredClass:"esri.layers.KMLGroundOverlay",
constructor:function(a){e.isDefined(this.visibility)&&(this.visible=!!this.visibility)}});g("extend-esri")&&n.setObject("layers.KMLGroundOverlay",m,l);return m})},"*noref":1}});
define("esri/layers/KMLLayer","dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/sniff dojo/io-query dojo/dom-construct dojo/dom-style ../kernel ../config ../lang ../request ../urlUtils ../SpatialReference ../geometry/webMercatorUtils ../dijit/PopupTemplate ./layer ./KMLFolder ./KMLGroundOverlay ./MapImageLayer ./FeatureLayer".split(" "),function(m,n,g,l,e,a,r,b,k,f,v,A,E,x,z,D,F,y,B,I,J,q,p){var t=n([B],{declaredClass:"esri.layers.KMLLayer",
serviceUrl:z.getProtocolForWebResource()+"//utility.arcgis.com/sharing/kml",constructor:function(a,b){a||console.log("KMLLayer:constructor - please provide url for the KML file");this._outSR=b&&b.outSR||new D({wkid:4326});this._options=l.mixin({},b);A.defaults.kmlService&&(this.serviceUrl=A.defaults.kmlService);var c=this.linkInfo=b&&b.linkInfo;c&&(this.visible=!!c.visibility,this._waitingForMap=!!c.viewFormat);(!c||c&&c.visibility&&!this._waitingForMap)&&this._parseKml();this.refresh=l.hitch(this,
this.refresh);this.registerConnectEvents("esri.layers.KMLLayer",!0)},getFeature:function(a){if(a){var b=a.type,c=a.id,h;switch(b){case "esriGeometryPoint":case "esriGeometryPolyline":case "esriGeometryPolygon":(a=this["_"+b])&&(h=l.getObject("_mode._featureMap."+c,!1,a));break;case "GroundOverlay":if(a=this._groundLyr){var f=a.getImages(),b=f.length;for(a=0;a<b;a++)if(f[a].id===c){h=f[a];break}}break;case "ScreenOverlay":break;case "NetworkLink":e.some(this._links,function(a){return a.linkInfo&&a.linkInfo.id===
c?(h=a,!0):!1});break;case "Folder":b=(f=this.folders)?f.length:0;for(a=0;a<b;a++)if(f[a].id===c){h=f[a];break}break;default:console.log("KMLLayer:getFeature - unknown feature type")}return h}},getLayers:function(){var a=[];this._groundLyr&&a.push(this._groundLyr);this._fLayers&&(a=a.concat(this._fLayers));this._links&&e.forEach(this._links,function(b){b.declaredClass&&a.push(b)});return a},setFolderVisibility:function(a,b){a&&(this._fireUpdateStart(),(a.visible=b)&&(b=this._areLocalAncestorsVisible(a)),
this._setState(a,b),this._fireUpdateEnd())},onRefresh:function(){},onOpacityChange:function(){},_parseKml:function(b){var d=this;this._fireUpdateStart();this._io=x({url:this.serviceUrl,content:{url:this._url.path+this._getQueryParameters(b),model:"simple",folders:"",refresh:this.loaded?!0:void 0,outSR:a.toJson(this._outSR.toJson())},callbackParamName:"callback",load:function(a){d._io=null;d._initLayer(a)},error:function(a){d._io=null;a=l.mixin(Error(),a);a.message="Unable to load KML: "+(a.message||
"");d._fireUpdateEnd(a);d.onError(a)}})},_initLayer:function(a){var b;this.loaded&&(b=[],e.forEach(this.folders,function(a){a.visible&&b.push(a.id)}),this._options.minScale=this.minScale,this._options.maxScale=this.maxScale,this._options.opacity=this.opacity,this._removeInternalLayers());this.name=a.name;this.description=a.description;this.snippet=a.snippet;this.visibility=a.visibility;this.featureInfos=a.featureInfos;var c,h,f=this.folders=a.folders,g=[],k;if(f)for(h=f.length,c=0;c<h;c++)k=f[c]=
new I(f[c]),-1===k.parentFolderId&&g.push(k);var f=this._links=a.networkLinks,m;h=f?f.length:0;for(c=0;c<h;c++)f[c].viewRefreshMode&&-1!==f[c].viewRefreshMode.toLowerCase().indexOf("onregion")||(m=l.mixin({},this._options),m.linkInfo=f[c],m.id&&(m.id=m.id+"_"+c),f[c]=new t(f[c].href,m),f[c]._parentLayer=this,f[c]._parentFolderId=this._getLinkParentId(f[c].linkInfo.id));if((f=a.groundOverlays)&&0<f.length)for(m=l.mixin({},this._options),m.id&&(m.id+="_mapImage"),k=this._groundLyr=new q(m),h=f.length,
c=0;c<h;c++)k.addImage(new J(f[c]));(a=l.getObject("featureCollection.layers",!1,a))&&0<a.length&&(this._fLayers=[],e.forEach(a,function(a,b){var c=l.getObject("featureSet.features",!1,a);c&&0<c.length&&(m=l.mixin({outFields:["*"],infoTemplate:a.popupInfo?new y(a.popupInfo):null,editable:!1},this._options),m.id&&(m.id=m.id+"_"+b),a.layerDefinition.capabilities="Query,Data",c=new p(a,m),c.geometryType&&(this["_"+c.geometryType]=c),this._fLayers.push(c))},this),0===this._fLayers.length&&delete this._fLayers);
if(!this.loaded)for(h=g.length,c=0;c<h;c++)k=g[c],this._setState(k,k.visible);this._fireUpdateEnd();this.loaded?(this._addInternalLayers(),e.forEach(this.folders,function(a){-1<e.indexOf(b,a.id)?this.setFolderVisibility(a,!0):this.setFolderVisibility(a,!1)},this),this.onRefresh()):(this.loaded=!0,this.onLoad(this))},_addInternalLayers:function(){var a=this._map;this._fireUpdateStart();this._links&&e.forEach(this._links,function(b){b.declaredClass&&(a.addLayer(b),b._waitingForMap&&(b._waitingForMap=
null,b.visible?b._parseKml(a):b._wMap=a))});var b=a.spatialReference,c=this._outSR,f;if(!b.equals(c))if(b.isWebMercator()&&4326===c.wkid)f=F.geographicToWebMercator;else if(c.isWebMercator()&&4326===b.wkid)f=F.webMercatorToGeographic;else{console.log("KMLLayer:_setMap - unsupported workflow. Spatial reference of the map and kml layer do not match, and the conversion cannot be done on the client.");return}this._groundLyr&&(f&&e.forEach(this._groundLyr.getImages(),function(a){a.extent=f(a.extent)}),
a.addLayer(this._groundLyr));(b=this._fLayers)&&0<b.length&&e.forEach(b,function(b){if(f){var c=b.graphics,d,e,h=c?c.length:0;for(d=0;d<h;d++)(e=c[d].geometry)&&c[d].setGeometry(f(e))}a.addLayer(b)});this.onVisibilityChange(this.visible)},_removeInternalLayers:function(){var a=this._map;this._links&&e.forEach(this._links,function(a){a.declaredClass&&a._io&&a._io.cancel()});a&&e.forEach(this.getLayers(),a.removeLayer,a)},_setState:function(a,b){var c=a.featureInfos,d,e,f,h=c?c.length:0,g=b?"show":
"hide";for(f=0;f<h;f++)if(d=c[f],e=this.getFeature(d))if("Folder"===d.type)this._setState(e,b&&e.visible);else if("NetworkLink"===d.type)this._setInternalVisibility(e,b);else e[g]()},_areLocalAncestorsVisible:function(a){var b=a.parentFolderId;for(a=a.visible;a&&-1!==b;)b=this.getFeature({type:"Folder",id:b}),a=a&&b.visible,b=b.parentFolderId;return a},_setInternalVisibility:function(a,b){var c=a._parentLayer,d=a._parentFolderId;for(b=b&&a.visible;b&&c;)b=b&&c.visible,-1<d&&(b=b&&c._areLocalAncestorsVisible(c.getFeature({type:"Folder",
id:d}))),d=c._parentFolderId,c=c._parentLayer;this._setIntState(a,b)},_setIntState:function(a,b){a&&e.forEach(a.getLayers(),function(c){c.linkInfo?a._setIntState(c,b&&c.visible&&a._areLocalAncestorsVisible(a.getFeature({type:"Folder",id:c._parentFolderId}))):c.setVisibility(b)})},_getLinkParentId:function(a){var b=-1;this.folders&&e.some(this.folders,function(c){return c.networkLinkIds&&-1!==e.indexOf(c.networkLinkIds,a)?(b=c.id,!0):!1});return b},_checkAutoRefresh:function(){var a=this.linkInfo;
if(a)if(this.visible){if(this.loaded&&this._map){var b=a.refreshMode,c=a.refreshInterval,e=a.viewRefreshMode,a=a.viewRefreshTime;b&&-1!==b.toLowerCase().indexOf("oninterval")&&0<c&&(this._stopAutoRefresh(),this._timeoutHandle=setTimeout(this.refresh,1E3*c));e&&-1!==e.toLowerCase().indexOf("onstop")&&0<a&&!this._extChgHandle&&(this._extChgHandle=g.connect(this._map,"onExtentChange",this,this._extentChanged))}}else this._stopAutoRefresh(),g.disconnect(this._extChgHandle),delete this._extChgHandle},
_stopAutoRefresh:function(){clearTimeout(this._timeoutHandle);this._timeoutHandle=null},_getQueryParameters:function(a){a=a||this._map;var d={},c=this.linkInfo,e=a&&a.extent,f;this._url.query&&(l.mixin(d,this._url.query),f=!!this._url.query.token);v.id&&!f&&(f=v.id.findCredential(this._url.path))&&(d.token=f.token);if(c){f=c.viewFormat;var h=c.httpQuery,c=c.viewBoundScale;if(e&&f){var g=e,k=e,n=e.spatialReference;n&&(n.isWebMercator()?g=F.webMercatorToGeographic(e):4326===n.wkid&&(k=F.geographicToWebMercator(e)));
e=g.getCenter();k=Math.max(k.getWidth(),k.getHeight());c&&(g=g.expand(c));f=f.replace(/\[bboxWest\]/ig,g.xmin).replace(/\[bboxEast\]/ig,g.xmax).replace(/\[bboxSouth\]/ig,g.ymin).replace(/\[bboxNorth\]/ig,g.ymax).replace(/\[lookatLon\]/ig,e.x).replace(/\[lookatLat\]/ig,e.y).replace(/\[lookatRange\]/ig,k).replace(/\[lookatTilt\]/ig,0).replace(/\[lookatHeading\]/ig,0).replace(/\[lookatTerrainLon\]/ig,e.x).replace(/\[lookatTerrainLat\]/ig,e.y).replace(/\[lookatTerrainAlt\]/ig,0).replace(/\[cameraLon\]/ig,
e.x).replace(/\[cameraLat\]/ig,e.y).replace(/\[cameraAlt\]/ig,k).replace(/\[horizFov\]/ig,60).replace(/\[vertFov\]/ig,60).replace(/\[horizPixels\]/ig,a.width).replace(/\[vertPixels\]/ig,a.height).replace(/\[terrainEnabled\]/ig,0);l.mixin(d,b.queryToObject(f))}h&&(h=h.replace(/\[clientVersion\]/ig,v.version).replace(/\[kmlVersion\]/ig,2.2).replace(/\[clientName\]/ig,"ArcGIS API for JavaScript").replace(/\[language\]/ig,m.locale),l.mixin(d,b.queryToObject(h)))}a=[];for(var p in d)E.isDefined(d[p])&&
a.push(p+"\x3d"+d[p]);return(a=a.join("\x26"))?"?"+a:""},setScaleRange:function(a,b){this.inherited(arguments);e.forEach(this.getLayers(),function(c){c.setScaleRange(a,b)})},setOpacity:function(a){this.opacity!=a&&(e.forEach(this.getLayers(),function(b){b.setOpacity(a)}),this.opacity=a,this.onOpacityChange(a))},_setMap:function(a,b){this.inherited(arguments);this._map=a;var c=this._div=k.create("div",null,b);f.set(c,"position","absolute");this._addInternalLayers();this.evaluateSuspension();return c},
_unsetMap:function(a,b){this._io&&this._io.cancel();this._stopAutoRefresh();g.disconnect(this._extChgHandle);delete this._extChgHandle;this._removeInternalLayers();var c=this._div;c&&(b.removeChild(c),k.destroy(c));this._wMap=this._div=null;this.inherited(arguments)},onVisibilityChange:function(a){this.loaded?(this._fireUpdateStart(),this._setInternalVisibility(this,a),this._checkAutoRefresh(),this._fireUpdateEnd()):this.linkInfo&&a&&(this._waitingForMap||this._parseKml(this._wMap))},refresh:function(){this.loaded&&
this._map&&!this._io&&this.visible&&this._parseKml()},getFeatureCollection:function(a){var b,c=[];(a=this.getFeature({type:"Folder",id:a}))&&(b=e.map(a.featureInfos,function(a){if("esriGeometryPoint"===a.type||"esriGeometryPolyline"===a.type||"esriGeometryPolygon"===a.type)return a.id},this))&&0<b.length&&e.forEach(this._fLayers,function(a){var d,f;d=a.toJson();d.featureSet.features&&0<d.featureSet.features.length&&(f=e.filter(d.featureSet.features,function(c){if(-1!==e.indexOf(b,c.attributes[a.objectIdField]))return c},
this));f&&0<f.length&&(d.featureSet.features=f,c.push(d))},this);return c},getFeatureCount:function(a){a=this.getFeature({type:"Folder",id:a});var b={points:0,polylines:0,polygons:0};a&&e.forEach(a.featureInfos,function(a){"esriGeometryPoint"===a.type&&(b.points+=1);"esriGeometryPolyline"===a.type&&(b.polylines+=1);"esriGeometryPolygon"===a.type&&(b.polygons+=1)});return b},_extentChanged:function(){this._stopAutoRefresh();this._timeoutHandle=setTimeout(this.refresh,1E3*this.linkInfo.viewRefreshTime)}});
r("extend-esri")&&l.setObject("layers.KMLLayer",t,v);return t});