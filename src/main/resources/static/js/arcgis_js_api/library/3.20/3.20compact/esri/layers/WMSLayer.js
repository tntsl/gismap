// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.20/esri/copyright.txt for details.
//>>built
require({cache:{"esri/dijit/PopupTemplate":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/dom-construct ../kernel ../InfoTemplate ../PopupInfo ./PopupRenderer".split(" "),function(h,g,p,w,d,b,q,n){h=h([b,q],{declaredClass:"esri.dijit.PopupTemplate","-chains-":{constructor:"manual"},chartTheme:null,constructor:function(b,f){g.mixin(this,f);this.initialize(b,f)},getTitle:function(b){var f;this.info&&(f=this.titleHasRelatedFields?"":this._getPopupValues(b,!0).title);return f||""},
getContent:function(b){return this.info?(new n({template:this,graphic:b,chartTheme:this.chartTheme},w.create("div"))).domNode:""}});p("extend-esri")&&g.setObject("dijit.PopupTemplate",h,d);return h})},"esri/PopupInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/i18n dojo/has dojo/Deferred dojo/sniff dojo/promise/all ./lang ./kernel ./request ./tasks/query ./tasks/QueryTask ./tasks/RelationshipQuery ./tasks/StatisticDefinition dojo/i18n!dojo/cldr/nls/number".split(" "),
function(h,g,p,w,d,b,q,n,k,f,y,D,v,z,C,E,H){h=h(null,{declaredClass:"esri.PopupInfo",initialize:function(a,c){if(a){g.mixin(this,c);this.info=a;this.title=this.getTitle;this.content=this.getContent;var e=this._fieldLabels={},u=this._fieldsMap={};a.fieldInfos&&p.forEach(a.fieldInfos,function(a){var c=a.fieldName.toLowerCase();e[c]=a.label;u[c]=a});this._relatedFieldPrefix="relationships/";this.titleHasRelatedFields=!(!a.title||-1===a.title.indexOf("{"+this._relatedFieldPrefix))}},toJson:function(){return w.fromJson(w.toJson(this.info))},
getTitle:function(){},getContent:function(){},getFieldInfo:function(a){var c;p.some(this.info&&this.info.fieldInfos,function(e){e.fieldName===a&&(c=e);return!!c});return c},getComponents:function(a){var c=this.info,e=new q,u,m;c.fieldInfos&&(m=p.filter(c.fieldInfos,function(a){return-1!==a.fieldName.indexOf(this._relatedFieldPrefix)},this));m&&0<m.length&&(u=this._getRelatedRecords({graphic:a,fieldsInfo:m}));u?u.always(g.hitch(this,function(){e.resolve(this._getPopupValues(a))})):e.resolve(this._getPopupValues(a));
return e.promise},getAttachments:function(a){var c=a.getLayer();a=a.attributes;if(this.info.showAttachments&&c&&c.hasAttachments&&c.objectIdField&&(a=a&&a[c.objectIdField]))return c.queryAttachmentInfos(a)},_getPopupValues:function(a,c){var e=this.info,u=a.getLayer(),m=g.clone(a.attributes)||{},t=g.clone(m),x=e.fieldInfos,B="",r="",l,A,F,b,v,z=u&&u._getDateOpts&&u._getDateOpts().properties,z=z&&z.slice(0),d={dateFormat:{properties:z,formatter:"DateFormat"+this._insertOffset(this._dateFormats.shortDateShortTime)}};
if(this._relatedInfo)for(b in this._relatedInfo)if(this._relatedInfo.hasOwnProperty(b)){var k=this._relatedInfo[b],n=this._relatedLayersInfo[b];k&&(p.forEach(k.relatedFeatures,function(a){for(v in a.attributes)if(a.attributes.hasOwnProperty(v)&&"esriRelCardinalityOneToOne"===n.relation.cardinality){var l=this._toRelatedFieldName([n.relation.id,v]);m[l]=t[l]=a.attributes[v]}},this),p.forEach(k.relatedStatsFeatures,function(a){for(v in a.attributes)if(a.attributes.hasOwnProperty(v)){var l=this._toRelatedFieldName([n.relation.id,
v]);m[l]=t[l]=a.attributes[v]}},this))}x&&p.forEach(x,function(a){A=a.fieldName;var l=this._getLayerFieldInfo(u,A);l&&(A=a.fieldName=l.name);t[A]=this._formatValue(t[A],A,d);z&&a.format&&a.format.dateFormat&&(a=p.indexOf(z,A),-1<a&&z.splice(a,1))},this);if(u){b=u.types;var q=(k=u.typeIdField)&&m[k];for(A in m)if(m.hasOwnProperty(A)&&-1===A.indexOf(this._relatedFieldPrefix)&&(F=m[A],f.isDefined(F))){var D=this._getDomainName(u,a,b,q,A,F);f.isDefined(D)?t[A]=D:A===k&&(D=this._getTypeName(u,a,F),f.isDefined(D)&&
(t[A]=D))}}e.title&&(B=this._processFieldsInLinks(this._fixTokens(e.title,u),m),B=g.trim(f.substitute(t,B,d)||""));if(c)return{title:B};e.description&&(r=this._processFieldsInLinks(this._fixTokens(e.description,u),m),r=g.trim(f.substitute(t,r,d)||""));x&&(l=[],p.forEach(x,function(a){(A=a.fieldName)&&a.visible&&l.push([a.label||A,f.substitute(t,"${"+A+"}",d)||""])}));var y,h;e.mediaInfos&&(y=[],p.forEach(e.mediaInfos,function(a){h=0;F=a.value;switch(a.type){case "image":var l=F.sourceURL,l=l&&g.trim(f.substitute(m,
this._fixTokens(l,u)));h=!!l;break;case "piechart":case "linechart":case "columnchart":case "barchart":var c,l=F.normalizeField;F.fields=p.map(F.fields,function(a){return(c=this._getLayerFieldInfo(u,a))?c.name:a},this);l&&(c=this._getLayerFieldInfo(u,l),F.normalizeField=c?c.name:l);h=p.some(F.fields,function(a){return f.isDefined(m[a])||-1!==a.indexOf(this._relatedFieldPrefix)&&this._relatedInfo},this);break;default:return}if(h){a=g.clone(a);F=a.value;var l=a.title?this._processFieldsInLinks(this._fixTokens(a.title,
u),m):"",r=a.caption?this._processFieldsInLinks(this._fixTokens(a.caption,u),m):"";a.title=l?g.trim(f.substitute(t,l,d)||""):"";a.caption=r?g.trim(f.substitute(t,r,d)||""):"";if("image"===a.type)F.sourceURL=f.substitute(m,this._fixTokens(F.sourceURL,u)),F.linkURL&&(F.linkURL=g.trim(f.substitute(m,this._fixTokens(F.linkURL,u))||""));else{var x,e;p.forEach(F.fields,function(a,l){if(-1!==a.indexOf(this._relatedFieldPrefix))e=this._getRelatedChartInfos(a,F,m,d),e instanceof Array?F.fields=e:F.fields[l]=
e;else{var c=m[a],c=void 0===c?null:c;x=m[F.normalizeField]||0;c&&x&&(c/=x);F.fields[l]={y:c,tooltip:(this._fieldLabels[a.toLowerCase()]||a)+":\x3cbr/\x3e"+this._formatValue(c,a,d,!!x)}}},this)}y.push(a)}},this));return{title:B,description:r,hasDescription:!!e.description,fields:l&&l.length?l:null,mediaInfos:y&&y.length?y:null,formatted:t,editSummary:u&&u.getEditSummary?u.getEditSummary(a):""}},_getRelatedChartInfos:function(a,c,e,u){var m,t,x,B,r,l;m=[];l=this._fromRelatedFieldName(a);r=l[0];t=this._relatedInfo[r];
r=this._relatedLayersInfo[r];t&&p.forEach(t.relatedFeatures,function(r){r=r.attributes;var t,A;for(A in r)if(r.hasOwnProperty(A)&&A===l[1]){t={};B=r[A];c.normalizeField&&(x=-1!==c.normalizeField.indexOf(this._relatedFieldPrefix)?r[this._fromRelatedFieldName(c.normalizeField)[1]]:e[c.normalizeField]);B&&x&&(B/=x);if(c.tooltipField)if(-1!==c.tooltipField.indexOf(this._relatedFieldPrefix)){var b=this._fromRelatedFieldName(c.tooltipField)[1],v=f.isDefined(r[b])?r[b]:b;t.tooltip=v+":\x3cbr/\x3e"+this._formatValue(B,
b,u,!!x)}else t.tooltip=(this._fieldLabels[a.toLowerCase()]||a)+":\x3cbr/\x3e"+this._formatValue(B,c.tooltipField,u,!!x);else t.tooltip=B;t.y=B;m.push(t)}},this);return"esriRelCardinalityOneToMany"===r.relation.cardinality||"esriRelCardinalityManyToMany"===r.relation.cardinality?m:m[0]},_dateFormats:{shortDate:"(datePattern: 'M/d/y', selector: 'date')",shortDateLE:"(datePattern: 'd/M/y', selector: 'date')",longMonthDayYear:"(datePattern: 'MMMM d, y', selector: 'date')",dayShortMonthYear:"(datePattern: 'd MMM y', selector: 'date')",
longDate:"(datePattern: 'EEEE, MMMM d, y', selector: 'date')",shortDateShortTime:"(datePattern: 'M/d/y', timePattern: 'h:mm a', selector: 'date and time')",shortDateLEShortTime:"(datePattern: 'd/M/y', timePattern: 'h:mm a', selector: 'date and time')",shortDateShortTime24:"(datePattern: 'M/d/y', timePattern: 'H:mm', selector: 'date and time')",shortDateLEShortTime24:"(datePattern: 'd/M/y', timePattern: 'H:mm', selector: 'date and time')",shortDateLongTime:"(datePattern: 'M/d/y', timePattern: 'h:mm:ss a', selector: 'date and time')",
shortDateLELongTime:"(datePattern: 'd/M/y', timePattern: 'h:mm:ss a', selector: 'date and time')",shortDateLongTime24:"(datePattern: 'M/d/y', timePattern: 'H:mm:ss', selector: 'date and time')",shortDateLELongTime24:"(datePattern: 'd/M/y', timePattern: 'H:mm:ss', selector: 'date and time')",longMonthYear:"(datePattern: 'MMMM y', selector: 'date')",shortMonthYear:"(datePattern: 'MMM y', selector: 'date')",year:"(datePattern: 'y', selector: 'date')"},_reHref:/href\s*=\s*\"([^\"]+)\"/ig,_reHrefApos:/href\s*=\s*\'([^\']+)\'/ig,
_fixTokens:function(a,c){var e=this;return a.replace(/(\{([^\{\r\n]+)\})/g,function(a,m,t){a=e._getLayerFieldInfo(c,t);return"$"+(a?"{"+a.name+"}":m)})},_encodeAttributes:function(a){a=g.clone(a)||{};var c,e;for(c in a)(e=a[c])&&"string"===typeof e&&(e=encodeURIComponent(e).replace(/\'/g,"\x26apos;"),a[c]=e);return a},_processFieldsInLinks:function(a,c){var e=this._encodeAttributes(c),u=this;a&&(a=a.replace(this._reHref,function(a,t){return u._addValuesToHref(a,t,c,e)}).replace(this._reHrefApos,function(a,
t){return u._addValuesToHref(a,t,c,e)}));return a},_addValuesToHref:function(a,c,e,u){c=c&&g.trim(c);return f.substitute(c&&0===c.indexOf("${")?e:u,a)},_getLayerFieldInfo:function(a,c){return a&&a.getField?a.getField(c):null},_formatValue:function(a,c,e,u){var m=this._fieldsMap[c.toLowerCase()],t=m&&m.format;c=-1!==p.indexOf(e.dateFormat.properties,c);var x="number"===typeof a&&!c&&(!t||!t.dateFormat);if(!f.isDefined(a)||!m||!f.isDefined(t))return x?this._forceLTR(a):a;var B="",m=[],r=t.hasOwnProperty("places")||
t.hasOwnProperty("digitSeparator"),l=t.hasOwnProperty("digitSeparator")?t.digitSeparator:!0;if(r&&!c)B="NumberFormat",m.push("places: "+(f.isDefined(t.places)&&(!u||0<t.places)?Number(t.places):"Infinity")),m.length&&(B+="("+m.join(",")+")");else if(t.dateFormat)B="DateFormat"+this._insertOffset(this._dateFormats[t.dateFormat]||this._dateFormats.shortDateShortTime);else return x?this._forceLTR(a):a;var A=this._applyFormatting(a,B,e);r&&-1<a.constructor.toString().indexOf("Array")&&(A="",p.forEach(a,
g.hitch(this,function(a,l){l&&(A+=" ");A+=this._applyFormatting(a,B,e)})));r&&!l&&H.group&&(A=A.replace(new RegExp("\\"+H.group,"g"),""));c&&(A='\x3cspan class\x3d"esriDateValue"\x3e'+A+"\x3c/span\x3e");return x?this._forceLTR(A):A},_applyFormatting:function(a,c,e){return f.substitute({myKey:a},"${myKey:"+c+"}",e)||""},_forceLTR:function(a){var c=n("ie");return c&&10>=c?a:"\x3cspan class\x3d'esriNumericValue'\x3e"+a+"\x3c/span\x3e"},_insertOffset:function(a){a&&(a=f.isDefined(this.utcOffset)?a.replace(/\)\s*$/,
", utcOffset:"+this.utcOffset+")"):a);return a},_getDomainName:function(a,c,e,u,m,t){return(a=a.getDomain&&a.getDomain(m,{feature:c}))&&a.codedValues?a.getName(t):null},_getTypeName:function(a,c,e){return(a=a.getType&&a.getType(c))&&a.name},_getRelatedRecords:function(a){var c=a.graphic,e=new q,u;this._relatedLayersInfo?this._queryRelatedLayers(c).then(g.hitch(this,function(a){this._setRelatedRecords(c,a);e.resolve(a)}),g.hitch(this,this._handlerErrorResponse,e)):this._getRelatedLayersInfo(a).then(g.hitch(this,
function(a){for(u in a)a.hasOwnProperty(u)&&a[u]&&(this._relatedLayersInfo[u].relatedLayerInfo=a[u]);this._queryRelatedLayers(c).then(g.hitch(this,function(a){this._setRelatedRecords(c,a);e.resolve(a)}),g.hitch(this,this._handlerErrorResponse,e))}),g.hitch(this,this._handlerErrorResponse,e));return e.promise},_getRelatedLayersInfo:function(a){var c=a.fieldsInfo,e,u,m={};e=a.graphic.getLayer();this._relatedLayersInfo||(this._relatedLayersInfo={});p.forEach(c,function(a){var c,m,r,l;c=this._fromRelatedFieldName(a.fieldName);
m=c[0];c=c[1];m&&(this._relatedLayersInfo[m]||(p.some(e.relationships,function(a){if(a.id==m)return l=a,!0}),l&&(this._relatedLayersInfo[m]={relation:l,relatedFields:[],outStatistics:[]})),this._relatedLayersInfo[m]&&(this._relatedLayersInfo[m].relatedFields.push(c),a.statisticType&&(r=new E,r.statisticType=a.statisticType,r.onStatisticField=c,r.outStatisticFieldName=c,this._relatedLayersInfo[m].outStatistics.push(r))))},this);for(u in this._relatedLayersInfo)this._relatedLayersInfo.hasOwnProperty(u)&&
this._relatedLayersInfo[u]&&(a=this._relatedLayersInfo[u].relation,a=e.url.replace(/[0-9]+$/,a.relatedTableId),this._relatedLayersInfo[u].relatedLayerUrl=a,m[u]=D({url:a,content:{f:"json"},callbackParamName:"callback"}));return k(m)},_queryRelatedLayers:function(a){var c={},e;for(e in this._relatedLayersInfo)this._relatedLayersInfo.hasOwnProperty(e)&&(c[e]=this._queryRelatedLayer({graphic:a,relatedInfo:this._relatedLayersInfo[e]}));return k(c)},_queryRelatedLayer:function(a){var c,e,u,m,t,x,B,r,l,
A,b,f,d;c=a.graphic;e=c.getLayer();u=e.url.match(/[0-9]+$/g)[0];b=a.relatedInfo;A=b.relatedLayerInfo;f=b.relatedLayerUrl;a=b.relation;p.some(A.relationships,function(a){if(a.relatedTableId===parseInt(u,10))return m=a,!0},this);m&&(t=new v,p.some(A.fields,function(a){if(a.name===m.keyField)return r=-1!==p.indexOf(["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],a.type)?"number":"string",!0}),m.relationshipTableId&&m.keyFieldInRelationshipTable?(d=new q,
this._queryRelatedRecords(c,m).then(g.hitch(this,function(a){var r;r=a[c.attributes[e.objectIdField]];a=p.map(r.features,function(a){return a.attributes[A.objectIdField]},this);b.outStatistics&&0<b.outStatistics.length&&A.supportsStatistics&&(l=new v,l.objectIds=a,l.outFields=t.outFields,l.outStatistics=b.outStatistics);l&&(x=new z(f),x.execute(l).then(g.hitch(this,function(a){var l=[];l.push(r);l.push(a);d.resolve(l)})))}))):(B="string"===r?m.keyField+"\x3d'"+c.attributes[a.keyField]+"'":m.keyField+
"\x3d"+c.attributes[a.keyField],t.where=B,t.outFields=b.relatedFields,b.outStatistics&&0<b.outStatistics.length&&A.supportsStatistics&&(l=new v,l.where=t.where,l.outFields=t.outFields,l.outStatistics=b.outStatistics),x=new z(f),B=[],B.push(x.execute(t)),l&&B.push(x.execute(l))));return B?k(B):d?d.promise:void 0},_setRelatedRecords:function(a,c){this._relatedInfo=[];for(var e in c)if(c.hasOwnProperty(e)&&c[e]){var b=c[e];this._relatedInfo[e]={};this._relatedInfo[e].relatedFeatures=b[0].features;f.isDefined(b[1])&&
(this._relatedInfo[e].relatedStatsFeatures=b[1].features)}},_handlerErrorResponse:function(a,c){a.reject(c)},_fromRelatedFieldName:function(a){var c=[];-1!==a.indexOf(this._relatedFieldPrefix)&&(a=a.split("/"),c=a.slice(1));return c},_toRelatedFieldName:function(a){var c="";a&&0<a.length&&(c=this._relatedFieldPrefix+a[0]+"/"+a[1]);return c},_queryRelatedRecords:function(a,c){var e=a.getLayer(),b=new C;b.outFields=["*"];b.relationshipId=c.id;b.objectIds=[a.attributes[e.objectIdField]];return e.queryRelatedFeatures(b)}});
b("extend-esri")&&(y.PopupInfo=y.PopupInfoTemplate=h);return h})},"esri/tasks/QueryTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has ../kernel ../request ../deferredUtils ../geometry/Extent ../geometry/normalizeUtils ./Task ./FeatureSet".split(" "),function(h,g,p,w,d,b,q,n,k,f,y,D,v){h=h(D,{declaredClass:"esri.tasks.QueryTask",_eventMap:{complete:["featureSet"],"execute-for-count-complete":["count"],"execute-for-ids-complete":["objectIds"],
"execute-relationship-query-complete":["featureSets"]},constructor:function(b,f){this._handler=g.hitch(this,this._handler);this._relationshipQueryHandler=g.hitch(this,this._relationshipQueryHandler);this._executeForIdsHandler=g.hitch(this,this._executeForIdsHandler);this._countHandler=g.hitch(this,this._countHandler);this._extentHandler=g.hitch(this,this._extentHandler);this.source=f&&f.source;this.gdbVersion=f&&f.gdbVersion;this.registerConnectEvents()},__msigns:[{n:"execute",c:4,a:[{i:0,p:["geometry"]}],
e:2},{n:"executeForIds",c:3,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForCount",c:3,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForExtent",c:3,a:[{i:0,p:["geometry"]}],e:2}],onComplete:function(){},onExecuteRelationshipQueryComplete:function(){},onExecuteForIdsComplete:function(){},onExecuteForCountComplete:function(){},onExecuteForExtentComplete:function(){},execute:function(b,f,v,k,a){var c=a.assembly;b=this._encode(g.mixin({},this._url.query,{f:"json"},b.toJson(c&&c[0])));var e=this._handler,u=this._errorHandler;
this.source&&(c={source:this.source.toJson()},b.layer=d.toJson(c));this.gdbVersion&&(b.gdbVersion=this.gdbVersion);return n({url:this._url.path+"/query",content:b,callbackParamName:"callback",load:function(c,t){e(c,t,f,v,a.dfd)},error:function(c){u(c,v,a.dfd)},callbackSuffix:k},this.requestOptions)},executeRelationshipQuery:function(b,f,v){b=this._encode(g.mixin({},this._url.query,{f:"json"},b.toJson()));var d=this._relationshipQueryHandler,a=this._errorHandler;this.gdbVersion&&(b.gdbVersion=this.gdbVersion);
var c=new w(k._dfdCanceller);c._pendingDfd=n({url:this._url.path+"/queryRelatedRecords",content:b,callbackParamName:"callback",load:function(a,b){d(a,b,f,v,c)},error:function(b){a(b,v,c)}},this.requestOptions);return c},executeForIds:function(b,f,v,k){var a=k.assembly;b=this._encode(g.mixin({},this._url.query,{f:"json",returnIdsOnly:!0},b.toJson(a&&a[0])));var c=this._executeForIdsHandler,e=this._errorHandler;this.source&&(a={source:this.source.toJson()},b.layer=d.toJson(a));this.gdbVersion&&(b.gdbVersion=
this.gdbVersion);return n({url:this._url.path+"/query",content:b,callbackParamName:"callback",load:function(a,m){c(a,m,f,v,k.dfd)},error:function(a){e(a,v,k.dfd)}},this.requestOptions)},executeForCount:function(b,f,v,k){var a=k.assembly;b=this._encode(g.mixin({},this._url.query,{f:"json",returnIdsOnly:!0,returnCountOnly:!0},b.toJson(a&&a[0])));var c=this._countHandler,e=this._errorHandler;this.source&&(a={source:this.source.toJson()},b.layer=d.toJson(a));this.gdbVersion&&(b.gdbVersion=this.gdbVersion);
return n({url:this._url.path+"/query",content:b,callbackParamName:"callback",load:function(a,m){c(a,m,f,v,k.dfd)},error:function(a){e(a,v,k.dfd)}},this.requestOptions)},executeForExtent:function(b,f,v,k){var a=k.assembly;b=this._encode(g.mixin({},this._url.query,{f:"json",returnExtentOnly:!0,returnCountOnly:!0},b.toJson(a&&a[0])));var c=this._extentHandler,e=this._errorHandler;this.source&&(a={source:this.source.toJson()},b.layer=d.toJson(a));this.gdbVersion&&(b.gdbVersion=this.gdbVersion);return n({url:this._url.path+
"/query",content:b,callbackParamName:"callback",load:function(a,m){c(a,m,f,v,k.dfd)},error:function(a){e(a,v,k.dfd)}},this.requestOptions)},_handler:function(b,f,k,d,a){try{var c=new v(b);this._successHandler([c],"onComplete",k,a)}catch(e){this._errorHandler(e,d,a)}},_relationshipQueryHandler:function(b,f,k,d,a){try{var c=b.geometryType,e=b.spatialReference,u={};p.forEach(b.relatedRecordGroups,function(a){var b={};b.geometryType=c;b.spatialReference=e;b.features=a.relatedRecords;b=new v(b);if(null!=
a.objectId)u[a.objectId]=b;else for(var m in a)a.hasOwnProperty(m)&&"relatedRecords"!==m&&(u[a[m]]=b)});this._successHandler([u],"onExecuteRelationshipQueryComplete",k,a)}catch(m){this._errorHandler(m,d,a)}},_executeForIdsHandler:function(b,f,v,k,a){try{this._successHandler([b.objectIds],"onExecuteForIdsComplete",v,a)}catch(c){this._errorHandler(c,k,a)}},_countHandler:function(b,f,v,k,a){try{var c,e=b.features,u=b.objectIds;if(u)c=u.length;else{if(e)throw Error("Unable to perform query. Please check your parameters.");
c=b.count}this._successHandler([c],"onExecuteForCountComplete",v,a)}catch(m){this._errorHandler(m,k,a)}},_extentHandler:function(b,v,k,d,a){try{b.extent&&(b.extent=new f(b.extent)),this._successHandler([b],"onExecuteForExtentComplete",k,a)}catch(c){this._errorHandler(c,d,a)}}});y._createWrappers(h);b("extend-esri")&&g.setObject("tasks.QueryTask",h,q);return h})},"esri/tasks/Task":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../deferredUtils ../urlUtils ../Evented".split(" "),
function(h,g,p,w,d,b,q,n){h=h(n,{declaredClass:"esri.tasks._Task",_eventMap:{error:["error"],complete:["result"]},constructor:function(b,f){b&&g.isString(b)&&(this._url=q.urlToObject(this.url=b));f&&f.requestOptions&&(this.requestOptions=f.requestOptions);this.normalization=!0;this._errorHandler=g.hitch(this,this._errorHandler);this.registerConnectEvents()},_useSSL:function(){var b=this._url,f=/^http:/i;this.url&&(this.url=this.url.replace(f,"https:"));b&&b.path&&(b.path=b.path.replace(f,"https:"))},
_encode:function(b,f,d){var k,v,n={},q,y;for(q in b)if("declaredClass"!==q&&(k=b[q],v=typeof k,null!==k&&void 0!==k&&"function"!==v))if(g.isArray(k))for(n[q]=[],y=k.length,v=0;v<y;v++)n[q][v]=this._encode(k[v]);else"object"===v?k.toJson&&(v=k.toJson(d&&d[q]),"esri.tasks.FeatureSet"===k.declaredClass&&v.spatialReference&&(v.sr=v.spatialReference,delete v.spatialReference),n[q]=f?v:p.toJson(v)):n[q]=k;return n},_successHandler:function(k,f,d,n){f&&this[f].apply(this,k);d&&d.apply(null,k);n&&b._resDfd(n,
k)},_errorHandler:function(b,f,d){this.onError(b);f&&f(b);d&&d.errback(b)},setNormalization:function(b){this.normalization=b},onError:function(){}});w("extend-esri")&&(d.Task=h);return h})},"esri/tasks/FeatureSet":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../graphic ../SpatialReference ../graphicsUtils ../geometry/jsonUtils ../symbols/jsonUtils".split(" "),function(h,g,p,w,d,b,q,n,k,f,y){h=h(null,{declaredClass:"esri.tasks.FeatureSet",constructor:function(b){if(b){g.mixin(this,
b);var v=this.features,d=b.spatialReference,k=f.getGeometryType(b.geometryType),d=this.spatialReference=new n(d);this.geometryType=b.geometryType;b.fields&&(this.fields=b.fields);p.forEach(v,function(b,f){var a=b.geometry&&b.geometry.spatialReference;v[f]=new q(k&&b.geometry?new k(b.geometry):null,b.symbol&&y.fromJson(b.symbol),b.attributes);v[f].geometry&&!a&&v[f].geometry.setSpatialReference(d)});this._hydrate()}else this.features=[]},displayFieldName:null,geometryType:null,spatialReference:null,
fieldAliases:null,toJson:function(d){var v={};this.displayFieldName&&(v.displayFieldName=this.displayFieldName);this.fields&&(v.fields=this.fields);this.spatialReference?v.spatialReference=this.spatialReference.toJson():this.features[0]&&this.features[0].geometry&&(v.spatialReference=this.features[0].geometry.spatialReference.toJson());this.features[0]&&(this.features[0].geometry&&(v.geometryType=f.getJsonType(this.features[0].geometry)),v.features=k._encodeGraphics(this.features,d));v.exceededTransferLimit=
this.exceededTransferLimit;v.transform=this.transform;return b.fixJson(v)},_hydrate:function(){var b=this.transform,f=this.geometryType;if(b&&f)for(var d=this.features,k=b.translate[0],n=b.translate[1],g=b.scale[0],a=b.scale[1],c=function(a,b,c){if("esriGeometryPoint"===a)return function(a){a.x=b(a.x);a.y=c(a.y)};if("esriGeometryPolyline"===a||"esriGeometryPolygon"===a)return function(a){a=a.rings||a.paths;var m,t,r,l,e,f,u,d;m=0;for(t=a.length;m<t;m++)for(e=a[m],r=0,l=e.length;r<l;r++)f=e[r],0<r?
(u+=f[0],d+=f[1]):(u=f[0],d=f[1]),f[0]=b(u),f[1]=c(d)};if("esriGeometryEnvelope"===a)return function(a){a.xmin=b(a.xmin);a.ymin=c(a.ymin);a.xmax=b(a.xmax);a.ymax=c(a.ymax)};if("esriGeometryMultipoint"===a)return function(a){a=a.points;var m,e,r,l,t;m=0;for(e=a.length;m<e;m++)r=a[m],0<m?(l+=r[0],t+=r[1]):(l=r[0],t=r[1]),r[0]=b(l),r[1]=c(t)}}(f,function(a){return a*g+k},function(b){return n-b*a}),b=0,f=d.length;b<f;b++)d[b].geometry&&c(d[b].geometry);this.transform=null},quantize:function(b){if(!this.geometryType)return this.transform=
null,this;var f=b.translate[0],d=b.translate[1],k=b.scale[0],n=b.scale[1],g=this.features,a=function(a,b,c){var m,r,l,e,t,x,f=[];m=0;for(r=a.length;m<r;m++)if(l=a[m],0<m){if(x=b(l[0]),l=c(l[1]),x!==e||l!==t)f.push([x-e,l-t]),e=x,t=l}else e=b(l[0]),t=c(l[1]),f.push([e,t]);return 0<f.length?f:null},c=function(b,c,e){if("esriGeometryPoint"===b)return function(a){a.x=c(a.x);a.y=e(a.y);return a};if("esriGeometryPolyline"===b||"esriGeometryPolygon"===b)return function(b){var r,l,m,t,x;m=b.rings||b.paths;
x=[];r=0;for(l=m.length;r<l;r++)t=m[r],(t=a(t,c,e))&&x.push(t);return 0<x.length?(b.rings?b.rings=x:b.paths=x,b):null};if("esriGeometryMultipoint"===b)return function(b){var r;r=a(b.points,c,e);return 0<r.length?(b.points=r,b):null};if("esriGeometryEnvelope"===b)return function(a){return a}}(this.geometryType,function(a){return Math.round((a-f)/k)},function(a){return Math.round((d-a)/n)}),e,u;e=0;for(u=g.length;e<u;e++)g[e].geometry&&(c(g[e].geometry)||g[e].setGeometry(null));this.transform=b;return this}});
w("extend-esri")&&g.setObject("tasks.FeatureSet",h,d);return h})},"esri/tasks/RelationshipQuery":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/json","dojo/has","../kernel"],function(h,g,p,w,d){h=h(null,{declaredClass:"esri.tasks.RelationshipQuery",definitionExpression:"",relationshipId:null,returnGeometry:!1,objectIds:null,outSpatialReference:null,outFields:null,toJson:function(){var b={definitionExpression:this.definitionExpression,relationshipId:this.relationshipId,returnGeometry:this.returnGeometry,
maxAllowableOffset:this.maxAllowableOffset,geometryPrecision:this.geometryPrecision},d=this.objectIds,n=this.outFields,k=this.outSpatialReference;d&&(b.objectIds=d.join(","));n&&(b.outFields=n.join(","));k&&(b.outSR=k.wkid||p.toJson(k.toJson()));b._ts=this._ts;return b}});w("extend-esri")&&g.setObject("tasks.RelationshipQuery",h,d);return h})},"esri/tasks/StatisticDefinition":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,g,p,w){h=h(null,{declaredClass:"esri.tasks.StatisticDefinition",
toJson:function(){return{statisticType:this.statisticType,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount}}});p("extend-esri")&&g.setObject("tasks.StatisticDefinition",h,w);return h})},"esri/dijit/PopupRenderer":function(){define("require dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/kernel dojo/sniff dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-style dojox/html/entities dijit/_Widget dijit/_Templated ../kernel ../urlUtils ./_EventedWidget dojo/i18n!../nls/jsapi dojo/NodeList-dom".split(" "),
function(h,g,p,w,d,b,q,n,k,f,y,D,v,z,C,E,H,a,c,e){var u=0;g=g([c,C,E],{declaredClass:"esri.dijit._PopupRenderer",constructor:function(){this._nls=w.mixin({},e.widgets.popup)},templateString:"\x3cdiv class\x3d'esriViewPopup'\x3e\x3cdiv class\x3d'mainSection'\x3e\x3cdiv class\x3d'header' dojoAttachPoint\x3d'_title'\x3e\x3c/div\x3e\x3cdiv class\x3d'hzLine'\x3e\x3c/div\x3e\x3cdiv dojoAttachPoint\x3d'_description'\x3e\x3c/div\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'attachmentsSection hidden'\x3e\x3cdiv\x3e${_nls.NLS_attach}:\x3c/div\x3e\x3cul dojoAttachPoint\x3d'_attachmentsList'\x3e\x3c/ul\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'mediaSection hidden'\x3e\x3cdiv class\x3d'header' dojoAttachPoint\x3d'_mediaTitle'\x3e\x3c/div\x3e\x3cdiv class\x3d'hzLine'\x3e\x3c/div\x3e\x3cdiv class\x3d'caption' dojoAttachPoint\x3d'_mediaCaption'\x3e\x3c/div\x3e\x3cdiv class\x3d'gallery' dojoAttachPoint\x3d'_gallery'\x3e\x3cdiv class\x3d'mediaHandle prev' dojoAttachPoint\x3d'_prevMedia' dojoAttachEvent\x3d'onclick: _goToPrevMedia'\x3e\x3c/div\x3e\x3cdiv class\x3d'mediaHandle next' dojoAttachPoint\x3d'_nextMedia' dojoAttachEvent\x3d'onclick: _goToNextMedia'\x3e\x3c/div\x3e\x3cul class\x3d'summary'\x3e\x3cli class\x3d'image mediaCount hidden' dojoAttachPoint\x3d'_imageCount'\x3e0\x3c/li\x3e\x3cli class\x3d'image mediaIcon hidden'\x3e\x3c/li\x3e\x3cli class\x3d'chart mediaCount hidden' dojoAttachPoint\x3d'_chartCount'\x3e0\x3c/li\x3e\x3cli class\x3d'chart mediaIcon hidden'\x3e\x3c/li\x3e\x3c/ul\x3e\x3cdiv class\x3d'frame' dojoAttachPoint\x3d'_mediaFrame'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'editSummarySection hidden' dojoAttachPoint\x3d'_editSummarySection'\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3cdiv class\x3d'break hidden' dojoAttachPoint\x3d'_mediaBreak'\x3e\x3c/div\x3e\x3cdiv class\x3d'editSummary' dojoAttachPoint\x3d'_editSummary'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e",
showTitle:!0,startup:function(){this.inherited(arguments);this.template.getComponents(this.graphic).then(w.hitch(this,this._handleComponentsSuccess),w.hitch(this,this._handleComponentsError))},destroy:function(){this._dfd&&this._dfd.cancel();this._destroyFrame();this.template=this.graphic=this._nls=this._mediaInfos=this._mediaPtr=this._dfd=null;this.inherited(arguments)},_goToPrevMedia:function(){0>this._mediaPtr-1||(this._mediaPtr--,this._updateUI(),this._displayMedia())},_goToNextMedia:function(){this._mediaPtr+
1!==this._mediaInfos.length&&(this._mediaPtr++,this._updateUI(),this._displayMedia())},_updateUI:function(){var a=this._mediaInfos,c=a.length,e=this.domNode,u=this._prevMedia,r=this._nextMedia;if(1<c){var l=0,A=0;d.forEach(a,function(a){"image"===a.type?l++:-1!==a.type.indexOf("chart")&&A++});l&&(f.set(this._imageCount,"innerHTML",l),b.query(".summary .image",e).removeClass("hidden"));A&&(f.set(this._chartCount,"innerHTML",A),b.query(".summary .chart",e).removeClass("hidden"))}else b.query(".summary",
e).addClass("hidden"),y.add(u,"hidden"),y.add(r,"hidden");a=this._mediaPtr;0===a?y.add(u,"hidden"):y.remove(u,"hidden");a===c-1?y.add(r,"hidden"):y.remove(r,"hidden");this._destroyFrame()},_displayMedia:function(){var a=this._mediaInfos[this._mediaPtr],c=a.title,e=a.caption,d=b.query(".mediaSection .hzLine",this.domNode)[0];f.set(this._mediaTitle,"innerHTML",c);y[c?"remove":"add"](this._mediaTitle,"hidden");f.set(this._mediaCaption,"innerHTML",e);y[e?"remove":"add"](this._mediaCaption,"hidden");y[c&&
e?"remove":"add"](d,"hidden");this._rid=null;if("image"===a.type)this._showImage(a.value);else{var r=this,c=["dojox/charting/Chart2D","dojox/charting/action2d/Tooltip"],e=a.value.theme||this.chartTheme;w.isString(e)&&(e=e.replace(/\./gi,"/"),-1===e.indexOf("/")&&(e="dojox/charting/themes/"+e));e||(e="./Rainbow");c.push(e);try{var l=this._rid=u++;h(c,function(b,c,e){l===r._rid&&(r._rid=null,r._showChart(a.type,a.value,b,c,e))})}catch(A){console.log("PopupRenderer: error loading modules")}}},_preventNewTab:function(a){return(a=
a&&w.trim(a).toLowerCase())&&(0===a.indexOf("mailto:")||0===a.indexOf("tel:"))},_showImage:function(a){y.add(this._mediaFrame,"image");var c=v.get(this._gallery,"height"),e;a.linkURL&&(e=D.create("a",{href:a.linkURL,target:this._preventNewTab(a.linkURL)?"":"_blank"},this._mediaFrame));D.create("img",{className:"esriPopupMediaImage",src:a.sourceURL},e||this._mediaFrame);var m=b.query(".esriPopupMediaImage",this._mediaFrame)[0],r=this,l;l=p.connect(m,"onload",function(){p.disconnect(l);l=null;r._imageLoaded(m,
c)})},_showChart:function(a,b,c,e,r){y.remove(this._mediaFrame,"image");c=this._chart=new c(D.create("div",{"class":"chart"},this._mediaFrame),{margins:{l:4,t:4,r:4,b:4}});r&&c.setTheme(r);switch(a){case "piechart":c.addPlot("default",{type:"Pie",labels:!1});c.addSeries("Series A",b.fields);break;case "linechart":c.addPlot("default",{type:"Markers"});c.addAxis("x",{min:0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1});c.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});d.forEach(b.fields,
function(a,b){a.x=b+1});c.addSeries("Series A",b.fields);break;case "columnchart":c.addPlot("default",{type:"Columns",gap:3});c.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});c.addSeries("Series A",b.fields);break;case "barchart":c.addPlot("default",{type:"Bars",gap:3}),c.addAxis("x",{includeZero:!0,fixUpper:"minor",minorLabels:!1}),c.addAxis("y",{vertical:!0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1}),c.addSeries("Series A",b.fields)}this._action=new e(c);c.render()},
_destroyFrame:function(){this._rid=null;this._chart&&(this._chart.destroy(),this._chart=null);this._action&&(this._action.destroy(),this._action=null);f.set(this._mediaFrame,"innerHTML","")},_imageLoaded:function(a,b){var c=a.height;c<b&&v.set(a,"marginTop",Math.round((b-c)/2)+"px")},_attListHandler:function(b,c){if(b===this._dfd){this._dfd=null;var e="";c instanceof Error||!c||!c.length||d.forEach(c,function(b){e+="\x3cli\x3e";e+="\x3ca href\x3d'"+a.addProxy(b.url)+"' target\x3d'_blank'\x3e"+(b.name||
"[No name]")+"\x3c/a\x3e";e+="\x3c/li\x3e"});f.set(this._attachmentsList,"innerHTML",e||"\x3cli\x3e"+this._nls.NLS_noAttach+"\x3c/li\x3e")}},_handleComponentsSuccess:function(a){if(a){var c=this.showTitle?a.title:"",e=a.description,m=a.fields,r=a.mediaInfos,l=this.domNode,u=this._nls,v=this,n=this.template,g=this.graphic;this._prevMedia.title=u.NLS_prevMedia;this._nextMedia.title=u.NLS_nextMedia;f.set(this._title,"innerHTML",c);c||y.add(this._title,"hidden");!a.hasDescription&&m&&(e="",d.forEach(m,
function(a){e+="\x3ctr valign\x3d'top'\x3e";e+="\x3ctd class\x3d'attrName'\x3e"+z.encode(a[0])+"\x3c/td\x3e";e+="\x3ctd class\x3d'attrValue'\x3e"+a[1].replace(/^\s*(https?:\/\/[^\s]+)\s*$/i,"\x3ca target\x3d'_blank' href\x3d'$1' title\x3d'$1'\x3e"+u.NLS_moreInfo+"\x3c/a\x3e")+"\x3c/td\x3e";e+="\x3c/tr\x3e"}),e&&(e="\x3ctable class\x3d'attrTable' cellpadding\x3d'0px' cellspacing\x3d'0px'\x3e"+e+"\x3c/table\x3e"));f.set(this._description,"innerHTML",e);e||y.add(this._description,"hidden");b.query("a",
this._description).forEach(function(a){v._preventNewTab(a.href)?"_blank"===a.target&&f.remove(a,"target"):f.set(a,"target","_blank")});c&&e?b.query(".mainSection .hzLine",l).removeClass("hidden"):c||e?b.query(".mainSection .hzLine",l).addClass("hidden"):b.query(".mainSection",l).addClass("hidden");if(c=this._dfd=n.getAttachments(g))c.addBoth(w.hitch(this,this._attListHandler,c)),f.set(this._attachmentsList,"innerHTML","\x3cli\x3e"+u.NLS_searching+"...\x3c/li\x3e"),b.query(".attachmentsSection",l).removeClass("hidden");
r&&r.length&&(b.query(".mediaSection",l).removeClass("hidden"),k.setSelectable(this._mediaFrame,!1),this._mediaInfos=r,this._mediaPtr=0,this._updateUI(),this._displayMedia());a.editSummary&&(f.set(this._editSummary,"innerHTML",a.editSummary),r&&r.length&&y.remove(this._mediaBreak,"hidden"),y.remove(this._editSummarySection,"hidden"))}},_handleComponentsError:function(a){console.log("PopupRenderer: error loading template",a)}});q("extend-esri")&&w.setObject("dijit._PopupRenderer",g,H);return g})},
"dojox/html/entities":function(){define(["dojo/_base/lang"],function(h){var g=h.getObject("dojox.html.entities",!0),p=function(d,b){var g,n;if(b._encCache&&b._encCache.regexp&&b._encCache.mapper&&b.length==b._encCache.length)g=b._encCache.mapper,n=b._encCache.regexp;else{g={};n=["["];var k;for(k=0;k<b.length;k++)g[b[k][0]]="\x26"+b[k][1]+";",n.push(b[k][0]);n.push("]");n=new RegExp(n.join(""),"g");b._encCache={mapper:g,regexp:n,length:b.length}}return d=d.replace(n,function(b){return g[b]})},w=function(d,
b){var g,n;if(b._decCache&&b._decCache.regexp&&b._decCache.mapper&&b.length==b._decCache.length)g=b._decCache.mapper,n=b._decCache.regexp;else{g={};n=["("];var k;for(k=0;k<b.length;k++){var f="\x26"+b[k][1]+";";k&&n.push("|");g[f]=b[k][0];n.push(f)}n.push(")");n=new RegExp(n.join(""),"g");b._decCache={mapper:g,regexp:n,length:b.length}}return d=d.replace(n,function(b){return g[b]})};g.html=[["\x26","amp"],['"',"quot"],["\x3c","lt"],["\x3e","gt"],["\u00a0","nbsp"]];g.latin=[["\u00a1","iexcl"],["\u00a2",
"cent"],["\u00a3","pound"],["\u20ac","euro"],["\u00a4","curren"],["\u00a5","yen"],["\u00a6","brvbar"],["\u00a7","sect"],["\u00a8","uml"],["\u00a9","copy"],["\u00aa","ordf"],["\u00ab","laquo"],["\u00ac","not"],["\u00ad","shy"],["\u00ae","reg"],["\u00af","macr"],["\u00b0","deg"],["\u00b1","plusmn"],["\u00b2","sup2"],["\u00b3","sup3"],["\u00b4","acute"],["\u00b5","micro"],["\u00b6","para"],["\u00b7","middot"],["\u00b8","cedil"],["\u00b9","sup1"],["\u00ba","ordm"],["\u00bb","raquo"],["\u00bc","frac14"],
["\u00bd","frac12"],["\u00be","frac34"],["\u00bf","iquest"],["\u00c0","Agrave"],["\u00c1","Aacute"],["\u00c2","Acirc"],["\u00c3","Atilde"],["\u00c4","Auml"],["\u00c5","Aring"],["\u00c6","AElig"],["\u00c7","Ccedil"],["\u00c8","Egrave"],["\u00c9","Eacute"],["\u00ca","Ecirc"],["\u00cb","Euml"],["\u00cc","Igrave"],["\u00cd","Iacute"],["\u00ce","Icirc"],["\u00cf","Iuml"],["\u00d0","ETH"],["\u00d1","Ntilde"],["\u00d2","Ograve"],["\u00d3","Oacute"],["\u00d4","Ocirc"],["\u00d5","Otilde"],["\u00d6","Ouml"],
["\u00d7","times"],["\u00d8","Oslash"],["\u00d9","Ugrave"],["\u00da","Uacute"],["\u00db","Ucirc"],["\u00dc","Uuml"],["\u00dd","Yacute"],["\u00de","THORN"],["\u00df","szlig"],["\u00e0","agrave"],["\u00e1","aacute"],["\u00e2","acirc"],["\u00e3","atilde"],["\u00e4","auml"],["\u00e5","aring"],["\u00e6","aelig"],["\u00e7","ccedil"],["\u00e8","egrave"],["\u00e9","eacute"],["\u00ea","ecirc"],["\u00eb","euml"],["\u00ec","igrave"],["\u00ed","iacute"],["\u00ee","icirc"],["\u00ef","iuml"],["\u00f0","eth"],["\u00f1",
"ntilde"],["\u00f2","ograve"],["\u00f3","oacute"],["\u00f4","ocirc"],["\u00f5","otilde"],["\u00f6","ouml"],["\u00f7","divide"],["\u00f8","oslash"],["\u00f9","ugrave"],["\u00fa","uacute"],["\u00fb","ucirc"],["\u00fc","uuml"],["\u00fd","yacute"],["\u00fe","thorn"],["\u00ff","yuml"],["\u0192","fnof"],["\u0391","Alpha"],["\u0392","Beta"],["\u0393","Gamma"],["\u0394","Delta"],["\u0395","Epsilon"],["\u0396","Zeta"],["\u0397","Eta"],["\u0398","Theta"],["\u0399","Iota"],["\u039a","Kappa"],["\u039b","Lambda"],
["\u039c","Mu"],["\u039d","Nu"],["\u039e","Xi"],["\u039f","Omicron"],["\u03a0","Pi"],["\u03a1","Rho"],["\u03a3","Sigma"],["\u03a4","Tau"],["\u03a5","Upsilon"],["\u03a6","Phi"],["\u03a7","Chi"],["\u03a8","Psi"],["\u03a9","Omega"],["\u03b1","alpha"],["\u03b2","beta"],["\u03b3","gamma"],["\u03b4","delta"],["\u03b5","epsilon"],["\u03b6","zeta"],["\u03b7","eta"],["\u03b8","theta"],["\u03b9","iota"],["\u03ba","kappa"],["\u03bb","lambda"],["\u03bc","mu"],["\u03bd","nu"],["\u03be","xi"],["\u03bf","omicron"],
["\u03c0","pi"],["\u03c1","rho"],["\u03c2","sigmaf"],["\u03c3","sigma"],["\u03c4","tau"],["\u03c5","upsilon"],["\u03c6","phi"],["\u03c7","chi"],["\u03c8","psi"],["\u03c9","omega"],["\u03d1","thetasym"],["\u03d2","upsih"],["\u03d6","piv"],["\u2022","bull"],["\u2026","hellip"],["\u2032","prime"],["\u2033","Prime"],["\u203e","oline"],["\u2044","frasl"],["\u2118","weierp"],["\u2111","image"],["\u211c","real"],["\u2122","trade"],["\u2135","alefsym"],["\u2190","larr"],["\u2191","uarr"],["\u2192","rarr"],
["\u2193","darr"],["\u2194","harr"],["\u21b5","crarr"],["\u21d0","lArr"],["\u21d1","uArr"],["\u21d2","rArr"],["\u21d3","dArr"],["\u21d4","hArr"],["\u2200","forall"],["\u2202","part"],["\u2203","exist"],["\u2205","empty"],["\u2207","nabla"],["\u2208","isin"],["\u2209","notin"],["\u220b","ni"],["\u220f","prod"],["\u2211","sum"],["\u2212","minus"],["\u2217","lowast"],["\u221a","radic"],["\u221d","prop"],["\u221e","infin"],["\u2220","ang"],["\u2227","and"],["\u2228","or"],["\u2229","cap"],["\u222a","cup"],
["\u222b","int"],["\u2234","there4"],["\u223c","sim"],["\u2245","cong"],["\u2248","asymp"],["\u2260","ne"],["\u2261","equiv"],["\u2264","le"],["\u2265","ge"],["\u2282","sub"],["\u2283","sup"],["\u2284","nsub"],["\u2286","sube"],["\u2287","supe"],["\u2295","oplus"],["\u2297","otimes"],["\u22a5","perp"],["\u22c5","sdot"],["\u2308","lceil"],["\u2309","rceil"],["\u230a","lfloor"],["\u230b","rfloor"],["\u2329","lang"],["\u232a","rang"],["\u25ca","loz"],["\u2660","spades"],["\u2663","clubs"],["\u2665",
"hearts"],["\u2666","diams"],["\u0152","OElig"],["\u0153","oelig"],["\u0160","Scaron"],["\u0161","scaron"],["\u0178","Yuml"],["\u02c6","circ"],["\u02dc","tilde"],["\u2002","ensp"],["\u2003","emsp"],["\u2009","thinsp"],["\u200c","zwnj"],["\u200d","zwj"],["\u200e","lrm"],["\u200f","rlm"],["\u2013","ndash"],["\u2014","mdash"],["\u2018","lsquo"],["\u2019","rsquo"],["\u201a","sbquo"],["\u201c","ldquo"],["\u201d","rdquo"],["\u201e","bdquo"],["\u2020","dagger"],["\u2021","Dagger"],["\u2030","permil"],["\u2039",
"lsaquo"],["\u203a","rsaquo"]];g.encode=function(d,b){d&&(b?d=p(d,b):(d=p(d,g.html),d=p(d,g.latin)));return d};g.decode=function(d,b){d&&(b?d=w(d,b):(d=w(d,g.html),d=w(d,g.latin)));return d};return g})},"dijit/_Widget":function(){define("dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/has dojo/_base/kernel dojo/_base/lang dojo/query dojo/ready ./registry ./_WidgetBase ./_OnDijitClickMixin ./_FocusMixin dojo/uacss ./hccss".split(" "),function(h,g,p,w,d,b,q,n,k,f,y,D,v){function z(){}
function C(b){return function(f,a,c,e){return f&&"string"==typeof a&&f[a]==z?f.on(a.substring(2).toLowerCase(),q.hitch(c,e)):b.apply(p,arguments)}}h.around(p,"connect",C);b.connect&&h.around(b,"connect",C);h=w("dijit._Widget",[y,D,v],{onClick:z,onDblClick:z,onKeyDown:z,onKeyPress:z,onKeyUp:z,onMouseDown:z,onMouseMove:z,onMouseOut:z,onMouseOver:z,onMouseLeave:z,onMouseEnter:z,onMouseUp:z,constructor:function(b){this._toConnect={};for(var f in b)this[f]===z&&(this._toConnect[f.replace(/^on/,"").toLowerCase()]=
b[f],delete b[f])},postCreate:function(){this.inherited(arguments);for(var b in this._toConnect)this.on(b,this._toConnect[b]);delete this._toConnect},on:function(b,f){return this[this._onMap(b)]===z?p.connect(this.domNode,b.toLowerCase(),this,f):this.inherited(arguments)},_setFocusedAttr:function(b){this._focused=b;this._set("focused",b)},setAttribute:function(f,d){b.deprecated(this.declaredClass+"::setAttribute(attr, value) is deprecated. Use set() instead.","","2.0");this.set(f,d)},attr:function(b,
f){return 2<=arguments.length||"object"===typeof b?this.set.apply(this,arguments):this.get(b)},getDescendants:function(){b.deprecated(this.declaredClass+"::getDescendants() is deprecated. Use getChildren() instead.","","2.0");return this.containerNode?n("[widgetId]",this.containerNode).map(f.byNode):[]},_onShow:function(){this.onShow()},onShow:function(){},onHide:function(){},onClose:function(){return!0}});d("dijit-legacy-requires")&&k(0,function(){require(["dijit/_base"])});return h})},"dijit/_WidgetBase":function(){define("require dojo/_base/array dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/_base/kernel dojo/_base/lang dojo/on dojo/ready dojo/Stateful dojo/topic dojo/_base/window ./Destroyable dojo/has!dojo-bidi?./_BidiMixin ./registry".split(" "),
function(h,g,p,w,d,b,q,n,k,f,y,D,v,z,C,E,H,a,c,e,u,m,t){function x(a){return function(b){n[b?"set":"remove"](this.domNode,a,b);this._set(a,b)}}v.add("dijit-legacy-requires",!z.isAsync);v.add("dojo-bidi",!1);v("dijit-legacy-requires")&&H(0,function(){h(["dijit/_base/manager"])});var B={};w=b("dijit._WidgetBase",[a,u],{id:"",_setIdAttr:"domNode",lang:"",_setLangAttr:x("lang"),dir:"",_setDirAttr:x("dir"),"class":"",_setClassAttr:{node:"domNode",type:"class"},_setTypeAttr:null,style:"",title:"",tooltip:"",
baseClass:"",srcNodeRef:null,domNode:null,containerNode:null,ownerDocument:null,_setOwnerDocumentAttr:function(a){this._set("ownerDocument",a)},attributeMap:{},_blankGif:w.blankGif||h.toUrl("dojo/resources/blank.gif"),textDir:"",_introspect:function(){var a=this.constructor;if(!a._setterAttrs){var b=a.prototype,c=a._setterAttrs=[],a=a._onMap={},e;for(e in b.attributeMap)c.push(e);for(e in b)/^on/.test(e)&&(a[e.substring(2).toLowerCase()]=e),/^_set[A-Z](.*)Attr$/.test(e)&&(e=e.charAt(4).toLowerCase()+
e.substr(5,e.length-9),b.attributeMap&&e in b.attributeMap||c.push(e))}},postscript:function(a,b){this.create(a,b)},create:function(a,b){this._introspect();this.srcNodeRef=q.byId(b);this._connects=[];this._supportingWidgets=[];this.srcNodeRef&&this.srcNodeRef.id&&"string"==typeof this.srcNodeRef.id&&(this.id=this.srcNodeRef.id);a&&(this.params=a,C.mixin(this,a));this.postMixInProperties();this.id||(this.id=t.getUniqueId(this.declaredClass.replace(/\./g,"_")),this.params&&delete this.params.id);this.ownerDocument=
this.ownerDocument||(this.srcNodeRef?this.srcNodeRef.ownerDocument:document);this.ownerDocumentBody=e.body(this.ownerDocument);t.add(this);this.buildRendering();var c;if(this.domNode){this._applyAttributes();var l=this.srcNodeRef;l&&l.parentNode&&this.domNode!==l&&(l.parentNode.replaceChild(this.domNode,l),c=!0);this.domNode.setAttribute("widgetId",this.id)}this.postCreate();c&&delete this.srcNodeRef;this._created=!0},_applyAttributes:function(){var a={},b;for(b in this.params||{})a[b]=this._get(b);
g.forEach(this.constructor._setterAttrs,function(b){if(!(b in a)){var c=this._get(b);c&&this.set(b,c)}},this);for(b in a)this.set(b,a[b])},postMixInProperties:function(){},buildRendering:function(){this.domNode||(this.domNode=this.srcNodeRef||this.ownerDocument.createElement("div"));if(this.baseClass){var a=this.baseClass.split(" ");this.isLeftToRight()||(a=a.concat(g.map(a,function(a){return a+"Rtl"})));k.add(this.domNode,a)}},postCreate:function(){},startup:function(){this._started||(this._started=
!0,g.forEach(this.getChildren(),function(a){a._started||a._destroyed||!C.isFunction(a.startup)||(a.startup(),a._started=!0)}))},destroyRecursive:function(a){this._beingDestroyed=!0;this.destroyDescendants(a);this.destroy(a)},destroy:function(a){function b(b){b.destroyRecursive?b.destroyRecursive(a):b.destroy&&b.destroy(a)}this._beingDestroyed=!0;this.uninitialize();g.forEach(this._connects,C.hitch(this,"disconnect"));g.forEach(this._supportingWidgets,b);this.domNode&&g.forEach(t.findWidgets(this.domNode,
this.containerNode),b);this.destroyRendering(a);t.remove(this.id);this._destroyed=!0},destroyRendering:function(a){this.bgIframe&&(this.bgIframe.destroy(a),delete this.bgIframe);this.domNode&&(a?n.remove(this.domNode,"widgetId"):f.destroy(this.domNode),delete this.domNode);this.srcNodeRef&&(a||f.destroy(this.srcNodeRef),delete this.srcNodeRef)},destroyDescendants:function(a){g.forEach(this.getChildren(),function(b){b.destroyRecursive&&b.destroyRecursive(a)})},uninitialize:function(){return!1},_setStyleAttr:function(a){var b=
this.domNode;C.isObject(a)?D.set(b,a):b.style.cssText=b.style.cssText?b.style.cssText+("; "+a):a;this._set("style",a)},_attrToDom:function(a,b,c){c=3<=arguments.length?c:this.attributeMap[a];g.forEach(C.isArray(c)?c:[c],function(c){var e=this[c.node||c||"domNode"];switch(c.type||"attribute"){case "attribute":C.isFunction(b)&&(b=C.hitch(this,b));c=c.attribute?c.attribute:/^on[A-Z][a-zA-Z]*$/.test(a)?a.toLowerCase():a;e.tagName?n.set(e,c,b):e.set(c,b);break;case "innerText":e.innerHTML="";e.appendChild(this.ownerDocument.createTextNode(b));
break;case "innerHTML":e.innerHTML=b;break;case "class":k.replace(e,b,this[a]);break;case "toggleClass":k.toggle(e,c.className||a,b)}},this)},get:function(a){var b=this._getAttrNames(a);return this[b.g]?this[b.g]():this._get(a)},set:function(a,b){if("object"===typeof a){for(var c in a)this.set(c,a[c]);return this}c=this._getAttrNames(a);var e=this[c.s];if(C.isFunction(e))var l=e.apply(this,Array.prototype.slice.call(arguments,1));else{var e=this.focusNode&&!C.isFunction(this.focusNode)?"focusNode":
"domNode",m=this[e]&&this[e].tagName,f;if((f=m)&&!(f=B[m])){f=this[e];var r={},t;for(t in f)r[t.toLowerCase()]=!0;f=B[m]=r}t=f;c=a in this.attributeMap?this.attributeMap[a]:c.s in this?this[c.s]:t&&c.l in t&&"function"!=typeof b||/^aria-|^data-|^role$/.test(a)?e:null;null!=c&&this._attrToDom(a,b,c);this._set(a,b)}return l||this},_attrPairNames:{},_getAttrNames:function(a){var b=this._attrPairNames;if(b[a])return b[a];var c=a.replace(/^[a-z]|-[a-zA-Z]/g,function(a){return a.charAt(a.length-1).toUpperCase()});
return b[a]={n:a+"Node",s:"_set"+c+"Attr",g:"_get"+c+"Attr",l:c.toLowerCase()}},_set:function(a,b){var c=this[a];this[a]=b;!this._created||c===b||c!==c&&b!==b||(this._watchCallbacks&&this._watchCallbacks(a,c,b),this.emit("attrmodified-"+a,{detail:{prevValue:c,newValue:b}}))},_get:function(a){return this[a]},emit:function(a,b,c){b=b||{};void 0===b.bubbles&&(b.bubbles=!0);void 0===b.cancelable&&(b.cancelable=!0);b.detail||(b.detail={});b.detail.widget=this;var e,l=this["on"+a];l&&(e=l.apply(this,c?
c:[b]));this._started&&!this._beingDestroyed&&E.emit(this.domNode,a.toLowerCase(),b);return e},on:function(a,b){var c=this._onMap(a);return c?p.after(this,c,b,!0):this.own(E(this.domNode,a,b))[0]},_onMap:function(a){var b=this.constructor,c=b._onMap;if(!c){var c=b._onMap={},e;for(e in b.prototype)/^on/.test(e)&&(c[e.replace(/^on/,"").toLowerCase()]=e)}return c["string"==typeof a&&a.toLowerCase()]},toString:function(){return"[Widget "+this.declaredClass+", "+(this.id||"NO ID")+"]"},getChildren:function(){return this.containerNode?
t.findWidgets(this.containerNode):[]},getParent:function(){return t.getEnclosingWidget(this.domNode.parentNode)},connect:function(a,b,c){return this.own(d.connect(a,b,this,c))[0]},disconnect:function(a){a.remove()},subscribe:function(a,b){return this.own(c.subscribe(a,C.hitch(this,b)))[0]},unsubscribe:function(a){a.remove()},isLeftToRight:function(){return this.dir?"ltr"==this.dir.toLowerCase():y.isBodyLtr(this.ownerDocument)},isFocusable:function(){return this.focus&&"none"!=D.get(this.domNode,"display")},
placeAt:function(a,b){var c=!a.tagName&&t.byId(a);!c||!c.addChild||b&&"number"!==typeof b?(c=c&&"domNode"in c?c.containerNode&&!/after|before|replace/.test(b||"")?c.containerNode:c.domNode:q.byId(a,this.ownerDocument),f.place(this.domNode,c,b),!this._started&&(this.getParent()||{})._started&&this.startup()):c.addChild(this,b);return this},defer:function(a,b){var c=setTimeout(C.hitch(this,function(){c&&(c=null,this._destroyed||C.hitch(this,a)())}),b||0);return{remove:function(){c&&(clearTimeout(c),
c=null);return null}}}});v("dojo-bidi")&&w.extend(m);return w})},"dijit/Destroyable":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare"],function(h,g,p){return p("dijit.Destroyable",null,{destroy:function(g){this._destroyed=!0},own:function(){var p=["destroyRecursive","destroy","remove"];h.forEach(arguments,function(d){function b(){n.remove();h.forEach(k,function(b){b.remove()})}var q,n=g.before(this,"destroy",function(b){d[q](b)}),k=[];d.then?(q="cancel",d.then(b,b)):h.forEach(p,
function(f){"function"===typeof d[f]&&(q||(q=f),k.push(g.after(d,f,b,!0)))})},this);return arguments}})})},"dijit/_OnDijitClickMixin":function(){define("dojo/on dojo/_base/array dojo/keys dojo/_base/declare dojo/has ./a11yclick".split(" "),function(h,g,p,w,d,b){h=w("dijit._OnDijitClickMixin",null,{connect:function(d,g,k){return this.inherited(arguments,[d,"ondijitclick"==g?b:g,k])}});h.a11yclick=b;return h})},"dijit/_FocusMixin":function(){define(["./focus","./_WidgetBase","dojo/_base/declare","dojo/_base/lang"],
function(h,g,p,w){w.extend(g,{focused:!1,onFocus:function(){},onBlur:function(){},_onFocus:function(){this.onFocus()},_onBlur:function(){this.onBlur()}});return p("dijit._FocusMixin",null,{_focusManager:h})})},"dijit/hccss":function(){define(["dojo/dom-class","dojo/hccss","dojo/domReady","dojo/_base/window"],function(h,g,p,w){p(function(){g("highcontrast")&&h.add(w.body(),"dijit_a11y")});return g})},"dojo/hccss":function(){define("require ./_base/config ./dom-class ./dom-style ./has ./domReady ./_base/window".split(" "),
function(h,g,p,w,d,b,q){d.add("highcontrast",function(){var b=q.doc.createElement("div");try{b.style.cssText='border: 1px solid; border-color:red green; position: absolute; height: 5px; top: -999px;background-image: url("'+(g.blankGif||h.toUrl("./resources/blank.gif"))+'");';q.body().appendChild(b);var k=w.getComputedStyle(b),f=k.backgroundImage;return k.borderTopColor==k.borderRightColor||f&&("none"==f||"url(invalid-url:)"==f)}catch(y){return console.warn("hccss: exception detecting high-contrast mode, document is likely hidden: "+
y.toString()),!1}finally{8>=d("ie")?b.outerHTML="":q.body().removeChild(b)}});b(function(){d("highcontrast")&&p.add(q.body(),"dj_a11y")});return d})},"dijit/_Templated":function(){define("./_WidgetBase ./_TemplatedMixin ./_WidgetsInTemplateMixin dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/_base/kernel".split(" "),function(h,g,p,w,d,b,q){b.extend(h,{waiRole:"",waiState:""});return d("dijit._Templated",[g,p],{constructor:function(){q.deprecated(this.declaredClass+": dijit._Templated deprecated, use dijit._TemplatedMixin and if necessary dijit._WidgetsInTemplateMixin",
"","2.0")},_processNode:function(b,d){var f=this.inherited(arguments),g=d(b,"waiRole");g&&b.setAttribute("role",g);(g=d(b,"waiState"))&&w.forEach(g.split(/\s*,\s*/),function(f){-1!=f.indexOf("-")&&(f=f.split("-"),b.setAttribute("aria-"+f[0],f[1]))});return f}})})},"dijit/_TemplatedMixin":function(){define("dojo/cache dojo/_base/declare dojo/dom-construct dojo/_base/lang dojo/on dojo/sniff dojo/string ./_AttachMixin".split(" "),function(h,g,p,w,d,b,q,n){var k=g("dijit._TemplatedMixin",n,{templateString:null,
templatePath:null,_skipNodeCache:!1,searchContainerNode:!0,_stringRepl:function(b){var f=this.declaredClass,d=this;return q.substitute(b,this,function(b,g){"!"==g.charAt(0)&&(b=w.getObject(g.substr(1),!1,d));if("undefined"==typeof b)throw Error(f+" template:"+g);return null==b?"":"!"==g.charAt(0)?b:this._escapeValue(""+b)},this)},_escapeValue:function(b){return b.replace(/["'<>&]/g,function(b){return{"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;"}[b]})},buildRendering:function(){if(!this._rendered){this.templateString||
(this.templateString=h(this.templatePath,{sanitize:!0}));var b=k.getCachedTemplate(this.templateString,this._skipNodeCache,this.ownerDocument),d;if(w.isString(b)){if(d=p.toDom(this._stringRepl(b),this.ownerDocument),1!=d.nodeType)throw Error("Invalid template: "+b);}else d=b.cloneNode(!0);this.domNode=d}this.inherited(arguments);this._rendered||this._fillContent(this.srcNodeRef);this._rendered=!0},_fillContent:function(b){var f=this.containerNode;if(b&&f)for(;b.hasChildNodes();)f.appendChild(b.firstChild)}});
k._templateCache={};k.getCachedTemplate=function(b,d,g){var f=k._templateCache,n=b,h=f[n];if(h){try{if(!h.ownerDocument||h.ownerDocument==(g||document))return h}catch(E){}p.destroy(h)}b=q.trim(b);if(d||b.match(/\$\{([^\}]+)\}/g))return f[n]=b;d=p.toDom(b,g);if(1!=d.nodeType)throw Error("Invalid template: "+b);return f[n]=d};b("ie")&&d(window,"unload",function(){var b=k._templateCache,d;for(d in b){var g=b[d];"object"==typeof g&&p.destroy(g);delete b[d]}});return k})},"dojo/cache":function(){define(["./_base/kernel",
"./text"],function(h){return h.cache})},"dijit/_AttachMixin":function(){define("require dojo/_base/array dojo/_base/connect dojo/_base/declare dojo/_base/lang dojo/mouse dojo/on dojo/touch ./_WidgetBase".split(" "),function(h,g,p,w,d,b,q,n,k){var f=d.delegate(n,{mouseenter:b.enter,mouseleave:b.leave,keypress:p._keypress}),y;p=w("dijit._AttachMixin",null,{constructor:function(){this._attachPoints=[];this._attachEvents=[]},buildRendering:function(){this.inherited(arguments);this._attachTemplateNodes(this.domNode);
this._beforeFillContent()},_beforeFillContent:function(){},_attachTemplateNodes:function(b){for(var d=b;;)if(1==d.nodeType&&(this._processTemplateNode(d,function(b,d){return b.getAttribute(d)},this._attach)||this.searchContainerNode)&&d.firstChild)d=d.firstChild;else{if(d==b)break;for(;!d.nextSibling;)if(d=d.parentNode,d==b)return;d=d.nextSibling}},_processTemplateNode:function(b,f,g){var k=!0,n=this.attachScope||this,v=f(b,"dojoAttachPoint")||f(b,"data-dojo-attach-point");if(v)for(var a=v.split(/\s*,\s*/);v=
a.shift();)d.isArray(n[v])?n[v].push(b):n[v]=b,k="containerNode"!=v,this._attachPoints.push(v);if(f=f(b,"dojoAttachEvent")||f(b,"data-dojo-attach-event"))for(v=f.split(/\s*,\s*/),a=d.trim;f=v.shift();)if(f){var c=null;-1!=f.indexOf(":")?(c=f.split(":"),f=a(c[0]),c=a(c[1])):f=a(f);c||(c=f);this._attachEvents.push(g(b,f,d.hitch(n,c)))}return k},_attach:function(b,d,g){d=d.replace(/^on/,"").toLowerCase();d="dijitclick"==d?y||(y=h("./a11yclick")):f[d]||d;return q(b,d,g)},_detachTemplateNodes:function(){var b=
this.attachScope||this;g.forEach(this._attachPoints,function(d){delete b[d]});this._attachPoints=[];g.forEach(this._attachEvents,function(b){b.remove()});this._attachEvents=[]},destroyRendering:function(){this._detachTemplateNodes();this.inherited(arguments)}});d.extend(k,{dojoAttachEvent:"",dojoAttachPoint:""});return p})},"dijit/_WidgetsInTemplateMixin":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang","dojo/parser"],function(h,g,p,w,d){return p("dijit._WidgetsInTemplateMixin",
null,{_earlyTemplatedStartup:!1,contextRequire:null,_beforeFillContent:function(){if(/dojoType|data-dojo-type/i.test(this.domNode.innerHTML)){var b=this.domNode;this.containerNode&&!this.searchContainerNode&&(this.containerNode.stopParser=!0);d.parse(b,{noStart:!this._earlyTemplatedStartup,template:!0,inherited:{dir:this.dir,lang:this.lang,textDir:this.textDir},propsThis:this,contextRequire:this.contextRequire,scope:"dojo"}).then(w.hitch(this,function(b){this._startupWidgets=b;for(var d=0;d<b.length;d++)this._processTemplateNode(b[d],
function(b,d){return b[d]},function(b,d,g){return d in b?b.connect(b,d,g):b.on(d,g,!0)});this.containerNode&&this.containerNode.stopParser&&delete this.containerNode.stopParser}));if(!this._startupWidgets)throw Error(this.declaredClass+": parser returned unfilled promise (probably waiting for module auto-load), unsupported by _WidgetsInTemplateMixin.   Must pre-load all supporting widgets before instantiation.");}},_processTemplateNode:function(b,d,g){return d(b,"dojoType")||d(b,"data-dojo-type")?
!0:this.inherited(arguments)},startup:function(){h.forEach(this._startupWidgets,function(b){b&&!b._started&&b.startup&&b.startup()});this._startupWidgets=null;this.inherited(arguments)}})})},"dojo/parser":function(){define("require ./_base/kernel ./_base/lang ./_base/array ./_base/config ./dom ./_base/window ./_base/url ./aspect ./promise/all ./date/stamp ./Deferred ./has ./query ./on ./ready".split(" "),function(h,g,p,w,d,b,q,n,k,f,y,D,v,z,C,E){function H(a){return eval("("+a+")")}function a(a){var b=
a._nameCaseMap,c=a.prototype;if(!b||b._extendCnt<e){var b=a._nameCaseMap={},d;for(d in c)"_"!==d.charAt(0)&&(b[d.toLowerCase()]=d);b._extendCnt=e}return b}function c(a,b){b||(b=h);var c=b._dojoParserCtorMap||(b._dojoParserCtorMap={}),e=a.join();if(!c[e]){for(var d=[],l=0,f=a.length;l<f;l++){var m=a[l];d[d.length]=c[m]=c[m]||p.getObject(m)||~m.indexOf("/")&&b(m)}l=d.shift();c[e]=d.length?l.createSubclass?l.createSubclass(d):l.extend.apply(l,d):l}return c[e]}new Date("X");var e=0;k.after(p,"extend",
function(){e++},!0);var u={_clearCache:function(){e++;_ctorMap={}},_functionFromScript:function(a,b){var c="",e="",d=a.getAttribute(b+"args")||a.getAttribute("args"),l=a.getAttribute("with"),d=(d||"").split(/\s*,\s*/);l&&l.length&&w.forEach(l.split(/\s*,\s*/),function(a){c+="with("+a+"){";e+="}"});return new Function(d,c+a.innerHTML+e)},instantiate:function(a,b,c){b=b||{};c=c||{};var e=(c.scope||g._scopeName)+"Type",d="data-"+(c.scope||g._scopeName)+"-",l=d+"type",f=d+"mixins",m=[];w.forEach(a,function(a){var c=
e in b?b[e]:a.getAttribute(l)||a.getAttribute(e);if(c){var d=a.getAttribute(f),c=d?[c].concat(d.split(/\s*,\s*/)):[c];m.push({node:a,types:c})}});return this._instantiate(m,b,c)},_instantiate:function(a,b,e,d){function m(a){b._started||e.noStart||w.forEach(a,function(a){"function"!==typeof a.startup||a._started||a.startup()});return a}a=w.map(a,function(a){var d=a.ctor||c(a.types,e.contextRequire);if(!d)throw Error("Unable to resolve constructor for: '"+a.types.join()+"'");return this.construct(d,
a.node,b,e,a.scripts,a.inherited)},this);return d?f(a).then(m):m(a)},construct:function(b,c,e,d,f,l){function m(a){D&&p.setObject(D,a);for(h=0;h<E.length;h++)k[E[h].advice||"after"](a,E[h].method,p.hitch(a,E[h].func),!0);for(h=0;h<K.length;h++)K[h].call(a);for(h=0;h<L.length;h++)a.watch(L[h].prop,L[h].func);for(h=0;h<M.length;h++)C(a,M[h].event,M[h].func);return a}var u=b&&b.prototype;d=d||{};var t={};d.defaults&&p.mixin(t,d.defaults);l&&p.mixin(t,l);var r;v("dom-attributes-explicit")?r=c.attributes:
v("dom-attributes-specified-flag")?r=w.filter(c.attributes,function(a){return a.specified}):(l=(/^input$|^img$/i.test(c.nodeName)?c:c.cloneNode(!1)).outerHTML.replace(/=[^\s"']+|="[^"]*"|='[^']*'/g,"").replace(/^\s*<[a-zA-Z0-9]*\s*/,"").replace(/\s*>.*$/,""),r=w.map(l.split(/\s+/),function(a){var b=a.toLowerCase();return{name:a,value:"LI"==c.nodeName&&"value"==a||"enctype"==b?c.getAttribute(b):c.getAttributeNode(b).value}}));var B=d.scope||g._scopeName;l="data-"+B+"-";var x={};"dojo"!==B&&(x[l+"props"]=
"data-dojo-props",x[l+"type"]="data-dojo-type",x[l+"mixins"]="data-dojo-mixins",x[B+"type"]="dojotype",x[l+"id"]="data-dojo-id");for(var h=0,q,B=[],D,I;q=r[h++];){var G=q.name,J=G.toLowerCase();q=q.value;switch(x[J]||J){case "data-dojo-type":case "dojotype":case "data-dojo-mixins":break;case "data-dojo-props":I=q;break;case "data-dojo-id":case "jsid":D=q;break;case "data-dojo-attach-point":case "dojoattachpoint":t.dojoAttachPoint=q;break;case "data-dojo-attach-event":case "dojoattachevent":t.dojoAttachEvent=
q;break;case "class":t["class"]=c.className;break;case "style":t.style=c.style&&c.style.cssText;break;default:if(G in u||(G=a(b)[J]||G),G in u)switch(typeof u[G]){case "string":t[G]=q;break;case "number":t[G]=q.length?Number(q):NaN;break;case "boolean":t[G]="false"!=q.toLowerCase();break;case "function":""===q||-1!=q.search(/[^\w\.]+/i)?t[G]=new Function(q):t[G]=p.getObject(q,!1)||new Function(q);B.push(G);break;default:J=u[G],t[G]=J&&"length"in J?q?q.split(/\s*,\s*/):[]:J instanceof Date?""==q?new Date(""):
"now"==q?new Date:y.fromISOString(q):J instanceof n?g.baseUrl+q:H(q)}else t[G]=q}}for(r=0;r<B.length;r++)x=B[r].toLowerCase(),c.removeAttribute(x),c[x]=null;if(I)try{I=H.call(d.propsThis,"{"+I+"}"),p.mixin(t,I)}catch(N){throw Error(N.toString()+" in data-dojo-props\x3d'"+I+"'");}p.mixin(t,e);f||(f=b&&(b._noScript||u._noScript)?[]:z("\x3e script[type^\x3d'dojo/']",c));var E=[],K=[],L=[],M=[];if(f)for(h=0;h<f.length;h++)x=f[h],c.removeChild(x),e=x.getAttribute(l+"event")||x.getAttribute("event"),d=
x.getAttribute(l+"prop"),I=x.getAttribute(l+"method"),B=x.getAttribute(l+"advice"),r=x.getAttribute("type"),x=this._functionFromScript(x,l),e?"dojo/connect"==r?E.push({method:e,func:x}):"dojo/on"==r?M.push({event:e,func:x}):t[e]=x:"dojo/aspect"==r?E.push({method:I,advice:B,func:x}):"dojo/watch"==r?L.push({prop:d,func:x}):K.push(x);b=(f=b.markupFactory||u.markupFactory)?f(t,c,b):new b(t,c);return b.then?b.then(m):m(b)},scan:function(a,b){function e(a){if(!a.inherited){a.inherited={};var b=a.node,c=
e(a.parent),b={dir:b.getAttribute("dir")||c.dir,lang:b.getAttribute("lang")||c.lang,textDir:b.getAttribute(k)||c.textDir},d;for(d in b)b[d]&&(a.inherited[d]=b[d])}return a.inherited}var d=[],f=[],l={},m=(b.scope||g._scopeName)+"Type",u="data-"+(b.scope||g._scopeName)+"-",t=u+"type",k=u+"textdir",u=u+"mixins",n=a.firstChild,q=b.inherited;if(!q){var p=function(a,b){return a.getAttribute&&a.getAttribute(b)||a.parentNode&&p(a.parentNode,b)},q={dir:p(a,"dir"),lang:p(a,"lang"),textDir:p(a,k)},y;for(y in q)q[y]||
delete q[y]}for(var q={inherited:q},z,C;;)if(n)if(1!=n.nodeType)n=n.nextSibling;else if(z&&"script"==n.nodeName.toLowerCase())(G=n.getAttribute("type"))&&/^dojo\/\w/i.test(G)&&z.push(n),n=n.nextSibling;else if(C)n=n.nextSibling;else{var G=n.getAttribute(t)||n.getAttribute(m);y=n.firstChild;if(G||y&&(3!=y.nodeType||y.nextSibling)){C=null;if(G){var E=n.getAttribute(u);z=E?[G].concat(E.split(/\s*,\s*/)):[G];try{C=c(z,b.contextRequire)}catch(K){}C||w.forEach(z,function(a){~a.indexOf("/")&&!l[a]&&(l[a]=
!0,f[f.length]=a)});E=C&&!C.prototype._noScript?[]:null;q={types:z,ctor:C,parent:q,node:n,scripts:E};q.inherited=e(q);d.push(q)}else q={node:n,scripts:z,parent:q};z=E;C=n.stopParser||C&&C.prototype.stopParser&&!b.template;n=y}else n=n.nextSibling}else{if(!q||!q.node)break;n=q.node.nextSibling;C=!1;q=q.parent;z=q.scripts}var H=new D;f.length?(v("dojo-debug-messages")&&console.warn("WARNING: Modules being Auto-Required: "+f.join(", ")),(b.contextRequire||h)(f,function(){H.resolve(w.filter(d,function(a){if(!a.ctor)try{a.ctor=
c(a.types,b.contextRequire)}catch(N){}for(var e=a.parent;e&&!e.types;)e=e.parent;var d=a.ctor&&a.ctor.prototype;a.instantiateChildren=!(d&&d.stopParser&&!b.template);a.instantiate=!e||e.instantiate&&e.instantiateChildren;return a.instantiate}))})):H.resolve(d);return H.promise},_require:function(a,b){var c=H("{"+a.innerHTML+"}"),e=[],d=[],f=new D,u=b&&b.contextRequire||h,m;for(m in c)e.push(m),d.push(c[m]);u(d,function(){for(var a=0;a<e.length;a++)p.setObject(e[a],arguments[a]);f.resolve(arguments)});
return f.promise},_scanAmd:function(a,b){var c=new D,e=c.promise;c.resolve(!0);var d=this;z("script[type\x3d'dojo/require']",a).forEach(function(a){e=e.then(function(){return d._require(a,b)});a.parentNode.removeChild(a)});return e},parse:function(a,c){!a||"string"==typeof a||"nodeType"in a||(c=a,a=c.rootNode);var e=a?b.byId(a):q.body();c=c||{};var d=c.template?{template:!0}:{},f=[],l=this,u=this._scanAmd(e,c).then(function(){return l.scan(e,c)}).then(function(a){return l._instantiate(a,d,c,!0)}).then(function(a){return f=
f.concat(a)}).otherwise(function(a){console.error("dojo/parser::parse() error",a);throw a;});p.mixin(f,u);return f}};g.parser=u;d.parseOnLoad&&E(100,u,"parse");return u})},"dojo/date/stamp":function(){define(["../_base/lang","../_base/array"],function(h,g){var p={};h.setObject("dojo.date.stamp",p);p.fromISOString=function(h,d){p._isoRegExp||(p._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/);var b=p._isoRegExp.exec(h),q=null;
if(b){b.shift();b[1]&&b[1]--;b[6]&&(b[6]*=1E3);d&&(d=new Date(d),g.forEach(g.map("FullYear Month Date Hours Minutes Seconds Milliseconds".split(" "),function(b){return d["get"+b]()}),function(d,g){b[g]=b[g]||d}));q=new Date(b[0]||1970,b[1]||0,b[2]||1,b[3]||0,b[4]||0,b[5]||0,b[6]||0);100>b[0]&&q.setFullYear(b[0]||1970);var n=0,k=b[7]&&b[7].charAt(0);"Z"!=k&&(n=60*(b[8]||0)+(Number(b[9])||0),"-"!=k&&(n*=-1));k&&(n-=q.getTimezoneOffset());n&&q.setTime(q.getTime()+6E4*n)}return q};p.toISOString=function(g,
d){var b=function(b){return 10>b?"0"+b:b};d=d||{};var q=[],n=d.zulu?"getUTC":"get",k="";"time"!=d.selector&&(k=g[n+"FullYear"](),k=["0000".substr((k+"").length)+k,b(g[n+"Month"]()+1),b(g[n+"Date"]())].join("-"));q.push(k);if("date"!=d.selector){k=[b(g[n+"Hours"]()),b(g[n+"Minutes"]()),b(g[n+"Seconds"]())].join(":");n=g[n+"Milliseconds"]();d.milliseconds&&(k+="."+(100>n?"0":"")+b(n));if(d.zulu)k+="Z";else if("time"!=d.selector)var n=g.getTimezoneOffset(),f=Math.abs(n),k=k+((0<n?"-":"+")+b(Math.floor(f/
60))+":"+b(f%60));q.push(k)}return q.join("T")};return p})},"esri/dijit/_EventedWidget":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/on ../Evented dijit/_WidgetBase".split(" "),function(h,g,p,w,d,b){return h([b,d],{_onMap:function(b){var d=this.constructor._onMap,g;d&&d.FINAL||(delete this.constructor._onMap,d=this.registerConnectEvents(),d.FINAL=!0);b=b.toLowerCase();d[b]?g=this[d[b].method]:(b=this._onCamelCase(b),this[b]&&(g=b));return g},on:function(b,d){var g=this._onMap(b),
f=b.replace(/\-/g,""),n="on"+f in this.domNode;return g||!n?this.inherited(arguments):this.own(w(this.domNode,f,d))[0]},emit:function(b,d,k){var f,n,h,q=b.toLowerCase(),p=this.constructor._onMap||this.registerConnectEvents();n=this[this._onMap(q)];d=d||{};d.target||(d.target=this);n&&p&&p[q]&&(this._onObj2Arr(function(){f=Array.prototype.slice.call(arguments)},p[q].argKeys)(d),h=g.mixin({},arguments),h[2]=f,h[0]=p[q].name.replace(/^on/,""));return this.inherited(h||arguments)}})})},"esri/layers/WMSLayerInfo":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/_base/array","dojo/has","../kernel"],function(h,g,p,w,d){h=h(null,{declaredClass:"esri.layers.WMSLayerInfo",name:null,title:null,description:null,extent:null,legendURL:null,subLayers:[],allExtents:[],spatialReferences:[],queryable:!1,showPopup:!1,constructor:function(b){b&&(this.name=b.name,this.title=b.title,this.description=b.description,this.extent=b.extent,this.legendURL=b.legendURL,this.subLayers=b.subLayers?b.subLayers:[],this.allExtents=b.allExtents?b.allExtents:[],
this.spatialReferences=b.spatialReferences?b.spatialReferences:[],this.queryable=!!b.queryable,this.showPopup=!!b.showPopup)},clone:function(){var b={name:this.name,title:this.title,description:this.description,legendURL:this.legendURL},d;this.extent&&(b.extent=this.extent.getExtent());b.subLayers=[];p.forEach(this.subLayers,function(d){b.subLayers.push(d.clone())});b.allExtents=[];for(d in this.allExtents)d=parseInt(d,10),isNaN(d)||(b.allExtents[d]=this.allExtents[d].getExtent());b.spatialReferences=
[];p.forEach(this.spatialReferences,function(d){b.spatialReferences.push(d)});b.queryable=this.queryable;b.showPopup=this.showPopup;return b}});w("extend-esri")&&g.setObject("layers.WMSLayerInfo",h,d);return h})},"*noref":1}});
define("esri/layers/WMSLayer","require dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/sniff ../config ../graphic ../kernel ../request ../urlUtils ../dijit/PopupTemplate ../SpatialReference ../geometry/Extent ../geometry/Point ./DynamicMapServiceLayer ./WMSLayerInfo dojo/query".split(" "),function(h,g,p,w,d,b,q,n,k,f,y,D,v,z,C,E,H){p=p([E],{declaredClass:"esri.layers.WMSLayer",_CRS_TO_EPSG:{84:4326,83:4269,27:4267},_REVERSED_LAT_LONG_RANGES:[[4001,4999],[2044,2045],[2081,
2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3300,3301],[3328,3335],[3346,3346],[3350,3352],[3366,3366],[3416,3416],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,
27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]],_WEB_MERCATOR:[102100,3857,102113,900913],_WORLD_MERCATOR:[3395,54004],allExtents:[],version:null,constructor:function(a,b){var c=y.urlToObject(a);c.query&&(c.query.version||c.query.Version||c.query.VERSION)&&(this.version=c.query.version||c.query.Version||c.query.VERSION);this.url=a=this._stripParameters(a,"version service request bbox format height width layers srs crs styles transparent bgcolor exceptions time elevation sld wfs".split(" "));
this._url=y.urlToObject(a);this._getCapabilitiesURL=a;this._initLayer=w.hitch(this,this._initLayer);this._parseCapabilities=w.hitch(this,this._parseCapabilities);this._getCapabilitiesError=w.hitch(this,this._getCapabilitiesError);b?(this.customParameters=b.customParameters,this.customLayerParameters=b.customLayerParameters,this.imageFormat=this._getImageFormat(b.format),this.imageTransparency=!1!==b.transparent,this.visibleLayers=b.visibleLayers?b.visibleLayers:[],this.version=b.version||this.version,
b.resourceInfo?this._readResourceInfo(b.resourceInfo):this._getCapabilities()):(this.imageFormat="image/png",this.imageTransparency=!0,this.visibleLayers=[],this._getCapabilities());this._blankImageURL=h.toUrl("../images/pixel.png");this.extentProcessor=this._createExtentProcessor(0);this._createChildLayer()},setVisibleLayers:function(a){this.visibleLayers=(a=this._checkVisibleLayersList(a))?a:[];this.refresh(!0)},setImageFormat:function(a){this.imageFormat=this._getImageFormat(a);this.refresh(!0)},
setImageTransparency:function(a){this.imageTransparency=a;this.refresh(!0)},setCustomParameters:function(a,b){this.customParameters=a;this.customLayerParameters=b;this.refresh(!0)},refresh:function(){this.inherited(arguments);this._childLayer&&this._childLayer.refresh.apply(this._childLayer,arguments)},getImageUrl:function(a,b,e,d){if(this.visibleLayers&&0!==this.visibleLayers.length){a=this._getImageParams(a,b,e);a=this._mixinCustomLayerParameters(a);b=this.getMapURL;var c;b+=-1===b.indexOf("?")?
"?":"";for(c in a)a.hasOwnProperty(c)&&(b+="?"===b.substring(b.length-1,b.length)?"":"\x26",b+=c+"\x3d"+a[c]);d(y.addProxy(b))}else d(this._blankImageURL)},_setMap:function(a,b,e){var c=this.inherited(arguments);a.wrapAround180?this._childLayer&&(this.suspended&&this._childLayer.suspend(),this._childLayer._setMap(a,c)):this._childLayer=this.extentProcessor=null;return c},_unsetMap:function(a,b){this._childLayer&&this._childLayer._unsetMap(a,this._div);this.inherited(arguments)},onSuspend:function(){this.inherited(arguments);
this._childLayer&&this._childLayer.suspend()},onResume:function(){this.inherited(arguments);this._childLayer&&this._childLayer.resume()},_createChildLayer:function(){this._childLayer=new E(null,{extentProcessor:this._createExtentProcessor(1)});this._childLayer._isChildLayer=!0;this._childLayer.getImageUrl=w.hitch(this,this.getImageUrl);this._childLayer.loaded=!0},_createExtentProcessor:function(a){return w.hitch(this,this._extentProcessor,a)},_extentProcessor:function(a,b){var c=b.extent,d=b.width,
f=0;if(c){var g=c.getWidth()/d,k=c.bisect(),c=k.extents,h=c[a];h&&(d=k.marginLeft/g,f=0===a?d:d+c[0].getWidth()/g,d=Math.ceil(h.getWidth()/g),f=Math.ceil(f));c=h}return{extent:c,width:d,marginLeft:f}},_getImageParams:function(a,b,e){var c=a.spatialReference.wkid;-1===d.indexOf(this.spatialReferences,c)&&a.spatialReference.latestWkid&&(c=a.spatialReference.latestWkid);if(d.some(this._WEB_MERCATOR,function(a){return a==c})){var f=d.filter(this.spatialReferences,function(a){return d.some(this._WEB_MERCATOR,
function(b){return b==a})},this);0===f.length&&(f=d.filter(this.spatialReferences,function(a){return d.some(this._WORLD_MERCATOR,function(b){return b==a})},this));c=0<f.length?f[0]:this._WEB_MERCATOR[0]}this.spatialReferences=d.filter(this.spatialReferences,function(a){return a!==c});this.spatialReferences.unshift(c);var f=a.xmin,g=a.xmax,k=a.ymin;a=a.ymax;var h={SERVICE:"WMS",REQUEST:"GetMap"};h.FORMAT=this.imageFormat;h.TRANSPARENT=this.imageTransparency?"TRUE":"FALSE";h.STYLES="";h.VERSION=this.version;
h.LAYERS=this.visibleLayers?this.visibleLayers.toString():null;h.WIDTH=b;h.HEIGHT=e;this.maxWidth<b&&(h.WIDTH=this.maxWidth);this.maxHeight<e&&(h.HEIGHT=this.maxHeight);b=c?c:NaN;isNaN(b)||("1.3.0"==this.version?h.CRS="EPSG:"+b:h.SRS="EPSG:"+b);"1.3.0"==this.version&&this._useLatLong(b)?h.BBOX=k+","+f+","+a+","+g:h.BBOX=f+","+k+","+g+","+a;return h},_initLayer:function(a,c){this.spatialReference=new v(this.extent.spatialReference);this.initialExtent=new z(this.extent);this.fullExtent=new z(this.extent);
this.visibleLayers=this._checkVisibleLayersList(this.visibleLayers);var d=w.hitch(this,function(){this.loaded=!0;this.onLoad(this);var a=this._loadCallback;a&&(delete this._loadCallback,a(this))});if(b("chrome")){var g=q.defaults.io,m="with-credentials"===g.useCors?y.canUseXhr(this.getMapURL,!0):-1;(g=-1<m?g.corsEnabledServers[m]:null)&&g.withCredentials?f({url:this.getMapURL,handleAs:"text",content:{SERVICE:"WMS",REQUEST:"GetMap"}}).addBoth(function(){d()}):d()}else d()},_readResourceInfo:function(a){a.extent?
a.layerInfos?(this.extent=a.extent,this.allExtents[0]=a.extent,this.layerInfos=a.layerInfos,this.description=a.description?a.description:"",this.copyright=a.copyright?a.copyright:"",this.title=a.title?a.title:"",this.getMapURL=a.getMapURL?a.getMapURL:this._getCapabilitiesURL,this.getFeatureInfoURL=a.getFeatureInfoURL,this.featureInfoFormat=a.featureInfoFormat,this.version=a.version?a.version:"1.3.0",this.maxWidth=a.maxWidth?a.maxWidth:5E3,this.maxHeight=a.maxHeight?a.maxHeight:5E3,this.spatialReferences=
a.spatialReferences?a.spatialReferences:[],this.imageFormat=this._getImageFormat(a.format),this.setScaleRange(a.minScale,a.maxScale),this.customLayerParameters=a.customLayerParameters||this.customLayerParameters,this.customParameters=a.customParameters||this.customParameters,this._initLayer()):this._errorHandler(Error("esri.layers.WMSLayer: unable to find the 'layerInfos' property in resourceInfo")):this._errorHandler(Error("esri.layers.WMSLayer: Unable to find the 'extent' property in resourceInfo."))},
_getCapabilities:function(){var a=this._url.query?this._url.query:{};a.SERVICE="WMS";a.REQUEST="GetCapabilities";this.version&&(a.VERSION=this.version);var a=this._mixinCustomParameters(a),b=this._url.path+"?",d;for(d in a)a.hasOwnProperty(d)&&(b+="?"==b.substring(b.length-1,b.length)?"":"\x26",b+=d+"\x3d"+a[d]);f({url:b,handleAs:"xml",headers:{"Content-Type":null},load:this._parseCapabilities,error:this._getCapabilitiesError},{usePost:!1})},_parseCapabilities:function(a){if(a){var b=this;this.version=
this._getAttributeValue("WMS_Capabilities","version",a,null);this.version||(this.version=this._getAttributeValue("WMT_MS_Capabilities","version",a,"1.3.0"));var e=this._getTag("Service",a);this.title=this._getTagValue("Title",e,"");this.title||(this.title=this._getTagValue("Name",e,""));this.copyright=this._getTagValue("AccessConstraints",e,"");this.description=this._getTagValue("Abstract",e,"");this.maxWidth=parseInt(this._getTagValue("MaxWidth",e,5E3),10);this.maxHeight=parseInt(this._getTagValue("MaxHeight",
e,5E3),10);if(e=this._getTag("Layer",a)){var f=this._getLayerInfo(e),m=0,h=null,e=this._getTag("Capability",a);d.forEach(e.childNodes,function(a){"Layer"==a.nodeName&&(0===m?h=a:(1===m&&f.name&&(f.name="",f.subLayers=[],f.subLayers.push(this._getLayerInfo(h))),f.subLayers.push(this._getLayerInfo(a))),m++)},this);if(f&&(this.layerInfos=f.subLayers,this.layerInfos&&0!==this.layerInfos.length||(this.layerInfos=[f]),this.extent=f.extent,this.extent||(f.extent=new z(this.layerInfos[0].extent.toJson()),
this.extent=f.extent),this.allExtents=f.allExtents,this.allExtents&&this.allExtents.length||(f.allExtents=[],d.forEach(this.layerInfos[0].allExtents,function(a,b){a&&(f.allExtents[b]=new z(a.toJson()))}),this.allExtents=f.allExtents),this.spatialReferences=f.spatialReferences,!this.spatialReferences.length&&0<this.layerInfos.length))for(var k=function(a){var b;for(b=0;b<a.subLayers.length;b++){var c=a.subLayers[b],d=c.spatialReferences;!d.length&&c.subLayers&&0<c.subLayers.length&&(d=k(c));if(d.length)return d}return[]},
e=0;e<this.layerInfos.length;e++){var n=this.layerInfos[e];this.spatialReferences=this.layerInfos[0].spatialReferences;!this.spatialReferences.length&&n.subLayers&&0<n.subLayers.length&&(this.spatialReferences=k(n));if(this.spatialReferences.length)break}e=function(c){return(c=g.query("DCPType",b._getTag(c,a)))&&0<c.length&&(c=g.query("HTTP",c[0]))&&0<c.length&&(c=g.query("Get",c[0]))&&0<c.length&&(c=b._getAttributeValue("OnlineResource","xlink:href",c[0],null))?(c.indexOf("\x26")===c.length-1&&(c=
c.substring(0,c.length-1)),b._stripParameters(c,["service","request"])):null};n=function(c){var e=[];0===g.query("Operation",a).length?d.forEach(g.query("Format",b._getTag(c,a)),function(a){e.push(a.text?a.text:a.textContent)}):d.forEach(g.query("Operation",a),function(a){a.getAttribute("name")===c&&d.forEach(g.query("Format",a),function(a){e.push(a.text?a.text:a.textContent)})});return e};this.getMapURL=e("GetMap")||this._getCapabilitiesURL;this.getMapFormats=n("GetMap");d.some(this.getMapFormats,
function(a){return-1<a.indexOf(this.imageFormat)},this)||(this.imageFormat=this.getMapFormats[0]);if(this.getFeatureInfoURL=e("GetFeatureInfo"))this.getFeatureInfoFormats=n("GetFeatureInfo"),-1<d.indexOf(this.getFeatureInfoFormats,"text/html")?this.featureInfoFormat="text/html":-1<d.indexOf(this.getFeatureInfoFormats,"text/plain")&&(this.featureInfoFormat="text/plain");if(!this.featureInfoFormat){var r=function(a){if(a&&(a.queryable=!1,a.subLayers))for(var b=0;b<a.subLayers.length;b++)r(a.subLayers[b])};
r(f)}this._initLayer()}else this._errorHandler(Error("esri.layers.WMSLayer: Response does not contain any layers."))}else this._errorHandler(Error("GetCapabilities request for "+this._getCapabilitiesURL+" failed. (Response is null.)"))},_getCapabilitiesError:function(a){a&&a.message&&(a.message="GetCapabilities request for "+this._getCapabilitiesURL+" failed. ("+a.message+")");this._errorHandler(a)},_getLayerInfo:function(a){if(!a)return null;var b=new H;b.name="";b.title="";b.description="";b.allExtents=
[];b.spatialReferences=[];b.queryable="1"===a.getAttribute("queryable");b.subLayers=[];var e=this._getTag("LatLonBoundingBox",a);e&&(b.allExtents[0]=this._getExtent(e,4326));var f=this._getTag("EX_GeographicBoundingBox",a),g;f&&(g=new z(0,0,0,0,new v({wkid:4326})),g.xmin=parseFloat(this._getTagValue("westBoundLongitude",f,0)),g.ymin=parseFloat(this._getTagValue("southBoundLatitude",f,0)),g.xmax=parseFloat(this._getTagValue("eastBoundLongitude",f,0)),g.ymax=parseFloat(this._getTagValue("northBoundLatitude",
f,0)),b.allExtents[0]=g);e||f||(g=new z(-180,-90,180,90,new v({wkid:4326})),b.allExtents[0]=g);b.extent=b.allExtents[0];var h=-1<d.indexOf(["1.0.0","1.1.0","1.1.1"],this.version)?"SRS":"CRS";d.forEach(a.childNodes,function(a){if("Name"==a.nodeName)b.name=(a.text?a.text:a.textContent)||"";else if("Title"==a.nodeName)b.title=(a.text?a.text:a.textContent)||"";else if("Abstract"==a.nodeName)b.description=(a.text?a.text:a.textContent)||"";else if("BoundingBox"==a.nodeName){var c=a.getAttribute(h);c&&0===
c.indexOf("EPSG:")?(c=parseInt(c.substring(5),10),0===c||isNaN(c)||(a="1.3.0"==this.version?this._getExtent(a,c,this._useLatLong(c)):this._getExtent(a,c),b.allExtents[c]=a,b.extent||(b.extent=a))):c&&0===c.indexOf("CRS:")?(c=parseInt(c.substring(4),10),0===c||isNaN(c)||(this._CRS_TO_EPSG[c]&&(c=this._CRS_TO_EPSG[c]),b.allExtents[c]=this._getExtent(a,c))):(c=parseInt(c,10),0===c||isNaN(c)||(b.allExtents[c]=this._getExtent(a,c)))}else if(a.nodeName==h)a=(a.text?a.text:a.textContent).split(" "),d.forEach(a,
function(a){a=-1<a.indexOf(":")?parseInt(a.split(":")[1],10):parseInt(a,10);0===a||isNaN(a)||(this._CRS_TO_EPSG[a]&&(a=this._CRS_TO_EPSG[a]),-1==d.indexOf(b.spatialReferences,a)&&b.spatialReferences.push(a))},this);else if("Style"!=a.nodeName||b.legendURL)"Layer"===a.nodeName&&b.subLayers.push(this._getLayerInfo(a));else if(a=this._getTag("LegendURL",a))if(a=this._getTag("OnlineResource",a))b.legendURL=a.getAttribute("xlink:href")},this);b.title=b.title||b.name;return b},_getImageFormat:function(a){switch(a?
a.toLowerCase():""){case "jpg":return"image/jpeg";case "bmp":return"image/bmp";case "gif":return"image/gif";case "svg":return"image/svg+xml";default:return"image/png"}},getImageFormat:function(){switch(this.imageFormat?this.imageFormat.toLowerCase():""){case "image/jpeg":return"jpg";case "image/bmp":return"bmp";case "image/gif":return"gif";case "image/svg+xml":return"svg";default:return"png"}},_getExtent:function(a,b,d){var c;if(a){c=new z;var e=parseFloat(a.getAttribute("minx")),f=parseFloat(a.getAttribute("miny")),
g=parseFloat(a.getAttribute("maxx"));a=parseFloat(a.getAttribute("maxy"));d?(c.xmin=isNaN(f)?-1*Number.MAX_VALUE:f,c.ymin=isNaN(e)?-1*Number.MAX_VALUE:e,c.xmax=isNaN(a)?Number.MAX_VALUE:a,c.ymax=isNaN(g)?Number.MAX_VALUE:g):(c.xmin=isNaN(e)?-1*Number.MAX_VALUE:e,c.ymin=isNaN(f)?-1*Number.MAX_VALUE:f,c.xmax=isNaN(g)?Number.MAX_VALUE:g,c.ymax=isNaN(a)?Number.MAX_VALUE:a);c.spatialReference=new v({wkid:b})}return c},_useLatLong:function(a){var b,d;for(d=0;d<this._REVERSED_LAT_LONG_RANGES.length;d++){var f=
this._REVERSED_LAT_LONG_RANGES[d];if(a>=f[0]&&a<=f[1]){b=!0;break}}return b},_getTag:function(a,b){var c=g.query(a,b);return c&&0<c.length?c[0]:null},_getTagValue:function(a,b,d){return(a=g.query(a,b))&&0<a.length?a[0].text?a[0].text:a[0].textContent:d},_getAttributeValue:function(a,b,d,f){return(a=g.query(a,d))&&0<a.length?a[0].getAttribute(b):f},_checkVisibleLayersList:function(a){if(a&&0<a.length&&this.layerInfos&&0<this.layerInfos.length&&"number"==typeof a[0]){var b=[];d.forEach(a,function(a){a<
this.layerInfos.length&&b.push(this.layerInfos[a].name)},this);a=b}return a},_stripParameters:function(a,b){var c=y.urlToObject(a),f,g=[];for(f in c.query)c.query.hasOwnProperty(f)&&-1===d.indexOf(b,f.toLowerCase())&&g.push(f+"\x3d"+c.query[f]);return c.path+(g.length?"?"+g.join("\x26"):"")},_getPopupGraphic:function(a,b){var c=this.visibleLayers;if(!c||0===c.length)return null;var f=this._popupGraphic;f||(f=new D({title:this.title||"",description:'\x3cdiv style\x3d"position:relative;padding-bottom:56.25%;height:0;overflow:hidden;max-width:100%;"\x3e\x3ciframe src\x3d"{QUERY_URL}" width\x3d"250" height\x3d"147" frameborder\x3d"0" marginwidth\x3d"0" marginheight\x3d"0" style\x3d"position:absolute;top:0;left:0;width:100%;height:100%;border:0;background:url(\''+
h.toUrl("../dijit/images/loading-throb.gif")+"') transparent center no-repeat;\" onload\x3d\"(event.target || event.srcElement).style.background \x3d 'none';\"\x3e\x3c/iframe\x3e\x3c/div\x3e"}),f=this._popupGraphic=new n(null,null,{},f),f._layer=this);var g=function(a){var b=[];if(a&&(a.queryable&&a.showPopup&&a.name&&b.push(a.name),a.subLayers))for(var c=0;c<a.subLayers.length;c++){var d=g(a.subLayers[c]);d.length&&(b=b.concat(d))}return b},k=g({subLayers:this.layerInfos}),k=d.filter(k,function(a){return-1<
d.indexOf(c,a)});if(k.length){var q=this.getFeatureInfoURL,p=this._getImageParams(a.extent,a.width,a.height),p=this._mixinCustomLayerParameters(p);p.REQUEST="GetFeatureInfo";p.INFO_FORMAT=this.featureInfoFormat;p.QUERY_LAYERS=k.join();p.FEATURE_COUNT=25;"1.3.0"===this.version?(p.I=Math.round(b.x),p.J=Math.round(b.y)):(p.X=Math.round(b.x),p.Y=Math.round(b.y));var q=q+(-1===q.indexOf("?")?"?":""),r;for(r in p)p.hasOwnProperty(r)&&(q+="?"===q.substring(q.length-1,q.length)?"":"\x26",q+=r+"\x3d"+p[r]);
f.attributes.QUERY_URL=q;return f}return null},_mixinCustomParameters:function(a){if(this.customParameters)for(var b in this.customParameters)a[b]=encodeURIComponent(this.customParameters[b]);return a},_mixinCustomLayerParameters:function(a){if(this.customLayerParameters||this.customParameters){var b=w.clone(this.customParameters||{});w.mixin(b,this.customLayerParameters||{});for(var d in b)"styles"===d.toLowerCase()&&delete a.STYLES,a[d]=encodeURIComponent(b[d])}return a}});b("extend-esri")&&w.setObject("layers.WMSLayer",
p,k);return p});